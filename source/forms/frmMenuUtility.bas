Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =5346
    DatasheetFontHeight =10
    ItemSuffix =12
    Left =9360
    Top =2556
    Right =14952
    Bottom =6792
    HelpContextId =90
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x3955d11af5b9e340
    End
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =0
    DatasheetGridlinesColor12 =12632256
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
            Width =1701
            Height =1701
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Section
            Height =4260
            BackColor =10803922
            Name ="Corpo"
            Begin
                Begin Label
                    SpecialEffect =4
                    BackStyle =1
                    OldBorderStyle =1
                    BorderWidth =2
                    OverlapFlags =85
                    TextAlign =2
                    Left =-45
                    Width =4785
                    Height =555
                    FontSize =20
                    FontWeight =700
                    BackColor =12311007
                    ForeColor =10040064
                    Name ="Etichetta7"
                    Caption ="UTILITY ORDINI"
                    FontName ="Verdana"
                    GridlineColor =-2147483622
                    LayoutCachedLeft =-45
                    LayoutCachedWidth =4740
                    LayoutCachedHeight =555
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =1695
                    Top =855
                    Width =2268
                    Height =1021
                    FontSize =10
                    FontWeight =700
                    ForeColor =10040064
                    Name ="cmdImportDataOracle"
                    Caption ="Import Ordini da Evadere"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ShortcutMenuBar ="Form Control Shortcut Bar"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000707880ff608090ff607880ff507080ff506070ff405860ff ,
                        0x405060ff404850ff404850ff404040ff303030ff202020ff1018208000000000 ,
                        0x0000000000000000708090ff80a0a0ff70b0d0ff0090d0ff0090d0ff1090d0ff ,
                        0x30a0d0ff50a8d0ff80b8d0ff80b8d0ff70a8c0ff5090b0ff305860ff30384050 ,
                        0x0000000000000000708090ff80c0d0ff80a0b0ff80e0ffff60d0ffff60d0ffff ,
                        0x70d0ffff509860ff308040ff206030ff90b8a0ff80c0e0ff5088a0ff303840c0 ,
                        0xfff8f00000000000708890ff80d0f0ff80a0b0ff80c0d0ff70d8ffff70d8ffff ,
                        0x80d8ffffb0e0ffff308040ff60a870ff206830ff80a890ff70b0e0ff406070ff ,
                        0x2038403000000000708890ff80d8f0ff80c8e0ff80a0b0ff80e0ffff70d8ffff ,
                        0x80d8ffffa0e0ffffd0f0ffff308040ff60a870ff206030ffa0d8f0ff5088a0ff ,
                        0x30587090fff8f000808890ff90e0f0ff90e0ffff90a0b0ff90b8c0ff80d8ffff ,
                        0x80d8ffffb0e8ffffe0f0ffff308040ff80d8a0ff206030ffd0e8f0ff80c8e0ff ,
                        0x707880f0705040608090a0ff90e0f0ffa0e8ffff80c0e0ff90a0b0ff90e0ffff ,
                        0xb0e8ffff308050ff308040ff60a870ff80d8a0ff308040ff206830ff307040ff ,
                        0x90c0e0ff706860d08090a0ffa0e8f0ffa0e8ffffa0e8ffff80a8b0ff90a8b0ff ,
                        0xa0b8c0ffb0c0b0ff308050ff70c080ff80d8a0ff50a060ff408050ffb0c0b0ff ,
                        0xa0a8b0ff8090a0ff8098a0ffa0e8f0ffa0f0ffffa0e8ffffa0e8ffff80d8ffff ,
                        0xc0b0a0fffff8f0ffd0e0d0ff408050ff60a870ff408050ffc0d0c0fffff8f0ff ,
                        0xffe8e0ff705040ff8098a0ffa0f0f0ffb0f0f0ffa0f0ffffa0e8ffffa0e8ffff ,
                        0xc0a8a0ffd0c0b0ffe0d0c0ffc0c8c0ff408050ffc0c8c0ffe0c8c0ffd0b8b0ff ,
                        0xc0b0a0ff604830ff8098a0ffa0d0e0ffb0f0f0ffb0f0f0ffa0f0ffffa0e8ffff ,
                        0xb0a8a0fffffffffffff8ffffd0c0c0fffff8f0fffff0e0ffd0b8b0fffff8f0ff ,
                        0xffe8e0ff604830ff8098a0508098a0ff8098a0ff8098a0ff8098a0ff8098a0ff ,
                        0xb0a8a0ffc0b0a0ffc0b8a0ffc0b0a0ffc0b0a0ffc0b0a0ffc0b0a0ffc0b0a0ff ,
                        0xc0b0a0ff604830ff000000000000000000000000000000000000000000000000 ,
                        0xb0a8a0ffffffffffffffffffc0b0a0fffff8fffffff0f0ffc0b0a0fffff8f0ff ,
                        0xfff0f0ff604830ff000000000000000000000000000000000000000000000000 ,
                        0xb09080ffb08060ffb08060ffb08060ffb07860ffb07860ffb07860ffb07860ff ,
                        0xb08060ffb08060ff000000000000000000000000000000000000000000000000 ,
                        0xb08870ffe0c8b0ffe0c0b0ffb08060ffe0c0b0ffe0c0b0ffb07860ffe0b8b0ff ,
                        0xe0b8b0ffb08060ff000000000000000000000000000000000000000000000000 ,
                        0xb08870ffc09080ffc09070ffb08870ffb08070ffb08060ffb08060ffb08060ff ,
                        0xb08060ffb08060ff
                    End

                    LayoutCachedLeft =1695
                    LayoutCachedTop =855
                    LayoutCachedWidth =3963
                    LayoutCachedHeight =1876
                    PictureCaptionArrangement =3
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =4770
                    Width =576
                    Height =576
                    TabIndex =1
                    ForeColor =0
                    Name ="cmdClose"
                    Caption ="(demo)"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    Tag ="ShiftLeftNewUnit,ShiftLeftPermLocn"
                    ControlTipText ="Close the form"

                    LayoutCachedLeft =4770
                    LayoutCachedWidth =5346
                    LayoutCachedHeight =576
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =1650
                    Top =2040
                    Width =2268
                    Height =1021
                    FontSize =10
                    FontWeight =700
                    TabIndex =2
                    ForeColor =10040064
                    Name ="cmdImportOrdiniStorico"
                    Caption ="Import Ordini Storico"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ShortcutMenuBar ="Form Control Shortcut Bar"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000707880ff608090ff607880ff507080ff506070ff405860ff ,
                        0x405060ff404850ff404850ff404040ff303030ff202020ff1018208000000000 ,
                        0x0000000000000000708090ff80a0a0ff70b0d0ff0090d0ff0090d0ff1090d0ff ,
                        0x30a0d0ff50a8d0ff80b8d0ff80b8d0ff70a8c0ff5090b0ff305860ff30384050 ,
                        0x0000000000000000708090ff80c0d0ff80a0b0ff80e0ffff60d0ffff60d0ffff ,
                        0x70d0ffff509860ff308040ff206030ff90b8a0ff80c0e0ff5088a0ff303840c0 ,
                        0xfff8f00000000000708890ff80d0f0ff80a0b0ff80c0d0ff70d8ffff70d8ffff ,
                        0x80d8ffffb0e0ffff308040ff60a870ff206830ff80a890ff70b0e0ff406070ff ,
                        0x2038403000000000708890ff80d8f0ff80c8e0ff80a0b0ff80e0ffff70d8ffff ,
                        0x80d8ffffa0e0ffffd0f0ffff308040ff60a870ff206030ffa0d8f0ff5088a0ff ,
                        0x30587090fff8f000808890ff90e0f0ff90e0ffff90a0b0ff90b8c0ff80d8ffff ,
                        0x80d8ffffb0e8ffffe0f0ffff308040ff80d8a0ff206030ffd0e8f0ff80c8e0ff ,
                        0x707880f0705040608090a0ff90e0f0ffa0e8ffff80c0e0ff90a0b0ff90e0ffff ,
                        0xb0e8ffff308050ff308040ff60a870ff80d8a0ff308040ff206830ff307040ff ,
                        0x90c0e0ff706860d08090a0ffa0e8f0ffa0e8ffffa0e8ffff80a8b0ff90a8b0ff ,
                        0xa0b8c0ffb0c0b0ff308050ff70c080ff80d8a0ff50a060ff408050ffb0c0b0ff ,
                        0xa0a8b0ff8090a0ff8098a0ffa0e8f0ffa0f0ffffa0e8ffffa0e8ffff80d8ffff ,
                        0xc0b0a0fffff8f0ffd0e0d0ff408050ff60a870ff408050ffc0d0c0fffff8f0ff ,
                        0xffe8e0ff705040ff8098a0ffa0f0f0ffb0f0f0ffa0f0ffffa0e8ffffa0e8ffff ,
                        0xc0a8a0ffd0c0b0ffe0d0c0ffc0c8c0ff408050ffc0c8c0ffe0c8c0ffd0b8b0ff ,
                        0xc0b0a0ff604830ff8098a0ffa0d0e0ffb0f0f0ffb0f0f0ffa0f0ffffa0e8ffff ,
                        0xb0a8a0fffffffffffff8ffffd0c0c0fffff8f0fffff0e0ffd0b8b0fffff8f0ff ,
                        0xffe8e0ff604830ff8098a0508098a0ff8098a0ff8098a0ff8098a0ff8098a0ff ,
                        0xb0a8a0ffc0b0a0ffc0b8a0ffc0b0a0ffc0b0a0ffc0b0a0ffc0b0a0ffc0b0a0ff ,
                        0xc0b0a0ff604830ff000000000000000000000000000000000000000000000000 ,
                        0xb0a8a0ffffffffffffffffffc0b0a0fffff8fffffff0f0ffc0b0a0fffff8f0ff ,
                        0xfff0f0ff604830ff000000000000000000000000000000000000000000000000 ,
                        0xb09080ffb08060ffb08060ffb08060ffb07860ffb07860ffb07860ffb07860ff ,
                        0xb08060ffb08060ff000000000000000000000000000000000000000000000000 ,
                        0xb08870ffe0c8b0ffe0c0b0ffb08060ffe0c0b0ffe0c0b0ffb07860ffe0b8b0ff ,
                        0xe0b8b0ffb08060ff000000000000000000000000000000000000000000000000 ,
                        0xb08870ffc09080ffc09070ffb08870ffb08070ffb08060ffb08060ffb08060ff ,
                        0xb08060ffb08060ff
                    End

                    LayoutCachedLeft =1650
                    LayoutCachedTop =2040
                    LayoutCachedWidth =3918
                    LayoutCachedHeight =3061
                    PictureCaptionArrangement =3
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =4965
                    Top =566
                    Width =381
                    Height =366
                    FontSize =9
                    FontWeight =700
                    TabIndex =3
                    ForeColor =10040115
                    Name ="cmdHelp"
                    Caption ="Help"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Composizione automatica"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =4965
                    LayoutCachedTop =566
                    LayoutCachedWidth =5346
                    LayoutCachedHeight =932
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =1650
                    Top =3225
                    Width =2268
                    Height =1021
                    FontSize =10
                    FontWeight =700
                    TabIndex =4
                    ForeColor =10040064
                    Name ="Comando11"
                    Caption ="frmStockOutCause"
                    OnClick ="=ApriMaschere(\"frmStockOutCause\")"
                    FontName ="Arial"
                    ShortcutMenuBar ="Form Control Shortcut Bar"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000707880ff608090ff607880ff507080ff506070ff405860ff ,
                        0x405060ff404850ff404850ff404040ff303030ff202020ff1018208000000000 ,
                        0x0000000000000000708090ff80a0a0ff70b0d0ff0090d0ff0090d0ff1090d0ff ,
                        0x30a0d0ff50a8d0ff80b8d0ff80b8d0ff70a8c0ff5090b0ff305860ff30384050 ,
                        0x0000000000000000708090ff80c0d0ff80a0b0ff80e0ffff60d0ffff60d0ffff ,
                        0x70d0ffff509860ff308040ff206030ff90b8a0ff80c0e0ff5088a0ff303840c0 ,
                        0xfff8f00000000000708890ff80d0f0ff80a0b0ff80c0d0ff70d8ffff70d8ffff ,
                        0x80d8ffffb0e0ffff308040ff60a870ff206830ff80a890ff70b0e0ff406070ff ,
                        0x2038403000000000708890ff80d8f0ff80c8e0ff80a0b0ff80e0ffff70d8ffff ,
                        0x80d8ffffa0e0ffffd0f0ffff308040ff60a870ff206030ffa0d8f0ff5088a0ff ,
                        0x30587090fff8f000808890ff90e0f0ff90e0ffff90a0b0ff90b8c0ff80d8ffff ,
                        0x80d8ffffb0e8ffffe0f0ffff308040ff80d8a0ff206030ffd0e8f0ff80c8e0ff ,
                        0x707880f0705040608090a0ff90e0f0ffa0e8ffff80c0e0ff90a0b0ff90e0ffff ,
                        0xb0e8ffff308050ff308040ff60a870ff80d8a0ff308040ff206830ff307040ff ,
                        0x90c0e0ff706860d08090a0ffa0e8f0ffa0e8ffffa0e8ffff80a8b0ff90a8b0ff ,
                        0xa0b8c0ffb0c0b0ff308050ff70c080ff80d8a0ff50a060ff408050ffb0c0b0ff ,
                        0xa0a8b0ff8090a0ff8098a0ffa0e8f0ffa0f0ffffa0e8ffffa0e8ffff80d8ffff ,
                        0xc0b0a0fffff8f0ffd0e0d0ff408050ff60a870ff408050ffc0d0c0fffff8f0ff ,
                        0xffe8e0ff705040ff8098a0ffa0f0f0ffb0f0f0ffa0f0ffffa0e8ffffa0e8ffff ,
                        0xc0a8a0ffd0c0b0ffe0d0c0ffc0c8c0ff408050ffc0c8c0ffe0c8c0ffd0b8b0ff ,
                        0xc0b0a0ff604830ff8098a0ffa0d0e0ffb0f0f0ffb0f0f0ffa0f0ffffa0e8ffff ,
                        0xb0a8a0fffffffffffff8ffffd0c0c0fffff8f0fffff0e0ffd0b8b0fffff8f0ff ,
                        0xffe8e0ff604830ff8098a0508098a0ff8098a0ff8098a0ff8098a0ff8098a0ff ,
                        0xb0a8a0ffc0b0a0ffc0b8a0ffc0b0a0ffc0b0a0ffc0b0a0ffc0b0a0ffc0b0a0ff ,
                        0xc0b0a0ff604830ff000000000000000000000000000000000000000000000000 ,
                        0xb0a8a0ffffffffffffffffffc0b0a0fffff8fffffff0f0ffc0b0a0fffff8f0ff ,
                        0xfff0f0ff604830ff000000000000000000000000000000000000000000000000 ,
                        0xb09080ffb08060ffb08060ffb08060ffb07860ffb07860ffb07860ffb07860ff ,
                        0xb08060ffb08060ff000000000000000000000000000000000000000000000000 ,
                        0xb08870ffe0c8b0ffe0c0b0ffb08060ffe0c0b0ffe0c0b0ffb07860ffe0b8b0ff ,
                        0xe0b8b0ffb08060ff000000000000000000000000000000000000000000000000 ,
                        0xb08870ffc09080ffc09070ffb08870ffb08070ffb08060ffb08060ffb08060ff ,
                        0xb08060ffb08060ff
                    End

                    LayoutCachedLeft =1650
                    LayoutCachedTop =3225
                    LayoutCachedWidth =3918
                    LayoutCachedHeight =4246
                    PictureCaptionArrangement =3
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit
Private Sub cmdClose_Click()
    DoCmd.Close acForm, Me.name
End Sub
Private Sub CmdMenuExport_Click()
    DoCmd.OpenForm "frmMenuExport"
Exit_CmdMenuExport_Click:
    Exit Sub

Err_CmdMenuExport_Click:
    MsgBox Err.Description
    Resume Exit_CmdMenuExport_Click
    
End Sub


Private Sub cmdHelp_Click()
Dim hwndHelp As Long
Call HelpEntry
End Sub

Private Sub cmdImportDataOracle_Click()
' ==== Importa via ODBC i dati da Oracle  ========

    Dim ws As Workspace
    Dim Db As Database
    Dim db0 As Database
    Dim Lconnect As String
    Dim MyQuery As String
    Dim MyRs As Recordset
    Dim qm As QueryDef
    Dim rst As Object
    Dim Response As Integer
    Dim conn As ADODB.Connection
    Dim intI As Double
    Dim sngPercento As Single
    Dim intMassimo As Variant
    ' Dim nRecords As Integer 'Long
    On Error GoTo Err_cmdImportDataOracle_Click:

    Response = MsgBox("Vuoi aggiornare gli ORDINI DA EVADERE da Oracle? ", vbYesNo, "Continue")
    If Response = vbYes Then
        Set db0 = CurrentDb
        Set conn = CurrentProject.Connection

        ' *** CONNESSIONE a Oracle

        ' On Error GoTo Err_Execute

        'Use {Microsoft ODBC for Oracle} ODBC connection
        'Lconnect = "ODBC;DSN=sun3000.scmgroup.com;UID=VPERAZZINI;PWD=BIC;SERVER=sun3000.scmgroup.com"
        Lconnect = LeggiOdbcConnect
        'Point to the current workspace
        Set ws = DBEngine.Workspaces(0)

        'Connect to Oracle
        Set Db = ws.OpenDatabase("", False, True, Lconnect)
        ' Setto il tempo di QueryTimeOut a 120 min
        Db.QueryTimeout = 240


        ' *** **************************************
        ' *** Inizio caricamento ordini_acquisto ***
        ' *** **************************************
        'Visualizza lo Status Meter
        Call acbInitMeter("IN ORD.ACQUISTO da ORACLE", True)
        'Reset lo Status Meter
        intI = 0
        sngPercento = 0
        ' Cancella dati
        conn.Execute "Delete * From tblPOrders"

        MyQuery = "SELECT NUMERO_DOC, " & _
                  "COD_ART, " & _
                  "COD_FORN, " & _
                  "DECODE (Ds_Rag_Soc, NULL, RAGSOC_FORN, Ds_Rag_Soc) Rag_Soc_Forn,  " & _
                  "DATA_ORDINE, " & _
                  "QTA_ORDINE, " & _
                  "QTA_RESIDUA, " & _
                  "DATA_RIC " & _
                  "FROM grp.RICACQU, grp.AN_CLIFOR_GRP " & _
                  "WHERE societa = ' SP' AND Sede_forn = cd_clfo(+)"
        '    /// QUESTA QUERY E' STATA FATTA PERCHE' RICACQ NON FUNZIONAVA (AGGIORNATA SETTIMANALMENTE
        '    MyQuery = "SELECT O.NU_ORD NUMERO_DOC, " & _
             '                "DO.CD_ART COD_ART, " & _
             '                "O.CD_CLFO COD_FORN, " & _
             '                "AF.DS_RAG_SOC Rag_Soc_Forn, " & _
             '                "DO.DT_RILASCIO_TEORICO DATA_ORDINE, " & _
             '                "DO.QT_ORD QTA_ORDINE, " & _
             '                "DO.QT_ORD - DO.QT_RICE QTA_RESIDUA, " & _
             '                "DO.DT_CONS_RICH DATA_RIC " & _
             '                "FROM GRP.ORDINE_FORNITORE O, GRP.DETTAG_ORD_FOR DO, GRP.AN_CLIFOR_GRP AF " & _
             '                "WHERE O.CD_SOC = ' SP' " & _
             '                "AND O.CD_SOC = DO.CD_SOC " & _
             '                "AND O.NU_ORD = DO.NU_ORD " & _
             '                "AND O.CD_CLFO = AF.CD_CLFO " & _
             '                "AND (DO.QT_ORD - DO.QT_RICE) > 0 "
        Set rst = Db.OpenRecordset(MyQuery, dbOpenSnapshot, dbSQLPassThrough)
        ' Numero Transazioni
        rst.MoveLast
        intMassimo = rst.RecordCount
        rst.MoveFirst
        
        Do While Not rst.EOF
            Set qm = db0.QueryDefs("qryPOrdersIsrt")
            qm!iNUMERO_DOC = rst![NUMERO_DOC]
            qm!iCOD_ART = rst![Cod_art]
            qm!iCOD_FORN = rst![COD_FORN]
            qm!iRag_Soc_Forn = rst![RAG_SOC_FORN]
            qm!iDATA_ORDINE = rst![DATA_ORDINE]
            qm!iQTA_ORDINE = rst![QTA_ORDINE]
            qm!iQTA_RESIDUA = rst![QTA_RESIDUA]
            qm!iDATA_RIC = rst![DATA_RIC]
            qm!iUpdateDate = Format(Date, "mm/dd/yyyy")
            qm.Execute
            rst.MoveNext
            ' Aggiorna lo Status Meter
            sngPercento = intI / (intMassimo / 100)
            If sngPercento >= 1 Then
                Call acbUpdateMeter(Int(sngPercento))
            End If
            intI = intI + 1
        Loop
        rst.Close
        'Close lo Status Meter
        Call acbCloseMeter
        'db.Close

        ' **************************************************************
        ' *** Inizio caricamento ordini_vendita SP NO TRIANGOLAZIONI ***
        ' **************************************************************

        'Visualizza lo Status Meter
        Call acbInitMeter("IN ORD.CLIENTI da ORACLE", True)
        'Reset lo Status Meter
        intI = 0
        sngPercento = 0
        ' Cancella dati
        conn.Execute "Delete * From tblCOrders"
        MyQuery = "SELECT NUMERO_DOC, " & _
                  "COD_CLI,  " & _
                  "DS_RAG_SOC, " & _
                  "RIGA_DOC, " & _
                  "UTENTE, " & _
                  "GRP.RICORCL.STATO, " & _
                  "GRP.RICORCL.COD_ART, " & _
                  "DESCRIZIONE, " & _
                  "flag_stock_out, " & _
                  "liv_urgenza, " & _
                  "DATA_ORDINE, " & _
                  "Data_Ord_cli, " & _
                  "Data_Prev_Cons, " & _
                  "qta_ord_umv, " & _
                  "qta_cons_umv, " & _
                  "Anagrafica.LEAD_TIME, " & "Anagrafica.MIN_MINMAX_QUANTITY ROP,  " & _
                  "Anagrafica.MAX_MINMAX_QUANTITY,  " & _
                  "Anagrafica.MINIMUM_ORDER_QUANTITY ROQ,  " & _
                  "Anagrafica.MAXIMUM_ORDER_QUANTITY, " & _
                  "TRIM(TO_CHAR(CS_CSC,'999999D9999','nls_numeric_characters = '',.''')) as CS_CSC "

        MyQuery = MyQuery & "FROM GRP.RICORCL, SP.ricanart Anagrafica, GRP.AN_CLIFOR_GRP, grp.AN_ARTICOLO " & _
                  "WHERE GRP.RICORCL.societa = ' SP' " & _
                  "AND COD_CLI = cd_clfo(+) " & _
                  "AND GRP.RICORCL.COD_ART = Anagrafica.COD_ART " & _
                  "AND GRP.RICORCL.COD_ART = GRP.AN_ARTICOLO.CD_ART " & _
                  "AND GRP.AN_ARTICOLO.CD_SOC = ' SP' " & _
                  "AND DATA_INIZ_NUM >= '01-gen-2011' " & _
                  "AND TIPO_DOC NOT LIKE '%COMPL MAC%' " & _
                  "AND TIPO_DOC NOT LIKE '%OMAGGI%' " & _
                  "AND TIPO_DOC NOT LIKE '%TRASFERIMENTO%' " & _
                  "AND funz_doc = 'A' " & _
                  "AND QTA_ORD_UMV != QTA_CONS_UMV " & _
                  "AND GRP.RICORCL.Stato = '1' "



        Set rst = Db.OpenRecordset(MyQuery, dbOpenSnapshot, dbSQLPassThrough)
        ' Numero Transazioni
        rst.MoveLast
        intMassimo = rst.RecordCount
        rst.MoveFirst
        
        Do While Not rst.EOF
            Set qm = db0.QueryDefs("qryCOrdersIsrt")
            qm!iNUMERO_DOC = rst![NUMERO_DOC]
            qm!iCOD_CLI = rst![COD_CLI]
            qm!iDS_RAG_SOC = rst![DS_RAG_SOC]
            qm!iRIGA_DOC = rst![RIGA_DOC]
            qm!iUTENTE = rst![UTENTE]
            qm!iSTATO = rst![Stato]
            qm!iCOD_ART = rst![Cod_art]
            qm!iDESCRIZIONE = rst![Descrizione]
            qm!iFLAG_STOCK_OUT = rst![FLAG_STOCK_OUT]
            qm!iLIV_URGENZA = rst![liv_urgenza]
            qm!iDATA_ORDINE = rst![DATA_ORDINE]
            qm!iData_Ord_cli = rst![Data_Ord_cli]
            qm!iData_Prev_Cons = rst![Data_Prev_Cons]
            qm!iqta_ord_umv = rst![qta_ord_umv]
            qm!iqta_cons_umv = rst![qta_cons_umv]
            qm!iLEAD_TIME = rst![Lead_time]
            qm!iROP = rst![ROP]
            qm!iMAX_MINMAX_QUANTITY = rst![MAX_MINMAX_QUANTITY]
            qm!iROQ = rst![ROQ]
            qm!iMAXIMUM_ORDER_QUANTITY = rst![MAXIMUM_ORDER_QUANTITY]
            qm!iCS_CSC = rst![Cs_Csc]
            qm!iUpdateDate = Format(Date, "mm/dd/yyyy")
            qm.Execute
            rst.MoveNext
            ' Aggiorna lo Status Meter
            sngPercento = intI / (intMassimo / 100)
            If sngPercento >= 1 Then
                Call acbUpdateMeter(Int(sngPercento))
            End If
            intI = intI + 1
        Loop
        rst.Close
        'Close lo Status Meter
        Call acbCloseMeter

        ' **************************************************************
        ' *** Inizio caricamento ordini_vendita SP  TRIANGOLAZIONI ***
        ' **************************************************************

        'Visualizza lo Status Meter
        Call acbInitMeter("IN ORD.CLIENTI TRIANGOLAZIONI", True)
        'Reset lo Status Meter
        intI = 0
        sngPercento = 0
        MyQuery = "SELECT NUMERO_DOC, " & _
                  "COD_CLI,  " & _
                  "DS_RAG_SOC, " & _
                  "RIGA_DOC, " & _
                  "UTENTE, " & _
                  "GRP.RICORCL.STATO, " & _
                  "GRP.RICORCL.COD_ART, " & _
                  "DESCRIZIONE, " & _
                  "flag_stock_out, " & _
                  "liv_urgenza, " & _
                  "DATA_ORDINE, " & _
                  "Data_Ord_cli, " & _
                  "Data_Prev_Cons, " & _
                  "qta_ord_umv, " & _
                  "qta_cons_umv, " & _
                  "Anagrafica.LEAD_TIME, " & "Anagrafica.MIN_MINMAX_QUANTITY ROP,  " & _
                  "Anagrafica.MAX_MINMAX_QUANTITY,  " & _
                  "Anagrafica.MINIMUM_ORDER_QUANTITY ROQ,  " & _
                  "Anagrafica.MAXIMUM_ORDER_QUANTITY, " & _
                  "TRIM(TO_CHAR(CS_CSC,'999999D9999','nls_numeric_characters = '',.''')) as CS_CSC "

        MyQuery = MyQuery & "FROM GRP.RICORCL, SP.ricanart Anagrafica, GRP.AN_CLIFOR_GRP, grp.AN_ARTICOLO " & _
                  "WHERE GRP.RICORCL.societa IN ('FD', 'FE', 'FF', 'FGB', 'FOLD', 'FPOL', 'TE') " & _
                  "AND COD_CLI = cd_clfo(+) " & _
                  "AND GRP.RICORCL.COD_ART = Anagrafica.COD_ART " & _
                  "AND GRP.RICORCL.COD_ART = GRP.AN_ARTICOLO.CD_ART " & _
                  "AND GRP.AN_ARTICOLO.CD_SOC = ' SP' " & _
                  "AND DATA_INIZ_NUM >= '01-gen-2011' " & _
                  "AND TIPO_DOC NOT LIKE '%COMPL MAC%' " & _
                  "AND TIPO_DOC NOT LIKE '%OMAGGI%' " & _
                  "AND TIPO_DOC NOT LIKE '%TRASFERIMENTO%' " & _
                  "   AND TIPO_DOC IN" + vbCrLf + _
                  "             ('FD R GARANTIE SCM'," + vbCrLf + _
                  "              'FD RD CNC SCM'," + vbCrLf + _
                  "              'FD RD STD SCM'," + vbCrLf + _
                  "              'FE R SCM'," + vbCrLf + _
                  "              'FF RF SCM'," + vbCrLf + _
                  "              'FF RG CEE SCM'," + vbCrLf + _
                  "              'FGB R WARRANTY SCM'," + vbCrLf + _
                  "              'FGB RG SCM'," + vbCrLf + _
                  "              'FO1 R GARANTIE SCM'," + vbCrLf + _
                  "              'FO1 RN SCM'," + vbCrLf + _
                  "              'FPL R GWARANC. SCM'," + vbCrLf + _
                  "              'FPL RP SCM'," + vbCrLf + _
                "              'TE RE SCM')"
        MyQuery = MyQuery & "AND funz_doc = 'A' " & _
                  "AND QTA_ORD_UMV != QTA_CONS_UMV " & _
                  "AND GRP.RICORCL.Stato = '1' "

        Set rst = Db.OpenRecordset(MyQuery, dbOpenSnapshot, dbSQLPassThrough)
        ' Numero Transazioni
        rst.MoveLast
        intMassimo = rst.RecordCount
        rst.MoveFirst
        
        Do While Not rst.EOF
            Set qm = db0.QueryDefs("qryCOrdersIsrt")
            qm!iNUMERO_DOC = rst![NUMERO_DOC]
            qm!iCOD_CLI = rst![COD_CLI]
            qm!iDS_RAG_SOC = rst![DS_RAG_SOC]
            qm!iRIGA_DOC = rst![RIGA_DOC]
            qm!iUTENTE = rst![UTENTE]
            qm!iSTATO = rst![Stato]
            qm!iCOD_ART = rst![Cod_art]
            qm!iDESCRIZIONE = rst![Descrizione]
            qm!iFLAG_STOCK_OUT = rst![FLAG_STOCK_OUT]
            qm!iLIV_URGENZA = rst![liv_urgenza]
            qm!iDATA_ORDINE = rst![DATA_ORDINE]
            qm!iData_Ord_cli = rst![Data_Ord_cli]
            qm!iData_Prev_Cons = rst![Data_Prev_Cons]
            qm!iqta_ord_umv = rst![qta_ord_umv]
            qm!iqta_cons_umv = rst![qta_cons_umv]
            qm!iLEAD_TIME = rst![Lead_time]
            qm!iROP = rst![ROP]
            qm!iMAX_MINMAX_QUANTITY = rst![MAX_MINMAX_QUANTITY]
            qm!iROQ = rst![ROQ]
            qm!iMAXIMUM_ORDER_QUANTITY = rst![MAXIMUM_ORDER_QUANTITY]
            qm!iCS_CSC = rst![Cs_Csc]
            qm!iUpdateDate = Format(Date, "mm/dd/yyyy")
            qm.Execute
            rst.MoveNext
            ' Aggiorna lo Status Meter
            sngPercento = intI / (intMassimo / 100)
            If sngPercento >= 1 Then
                Call acbUpdateMeter(Int(sngPercento))
            End If
            intI = intI + 1
        Loop
        rst.Close
        'Close lo Status Meter
        Call acbCloseMeter


        ' ***********************************************
        ' *** Inizia caricamento Ordini in Spedizione ***
        ' ***********************************************
        'Visualizza lo Status Meter
        Call acbInitMeter("CARICA ORDINI IN SPEDIZIONE da ORACLE", True)
        'Reset lo Status Meter
        intI = 1
        sngPercento = 0
        ' Cancella dati
        conn.Execute "Delete * From tblCOrdersSpediz"
        MyQuery = "SELECT NUMERO_DOC_ORD, " & _
                  "RIGA_DOC_ORD " & _
                  "FROM grp.ricsped  " & _
                  "WHERE societa = ' SP' " & _
                  "AND DATA_INIZ_NUM >= '01-gen-2011' " & _
                  "AND STATO_CONSEGNA IN " & _
                  "('Messa in attesa/prelievo confermato', 'Rilasciata a magazzino') "
        Set rst = Db.OpenRecordset(MyQuery, dbOpenSnapshot, dbSQLPassThrough)
        ' Numero Transazioni
        rst.MoveLast
        intMassimo = rst.RecordCount
        rst.MoveFirst
        
        Do While Not rst.EOF
            Set qm = db0.QueryDefs("qryCOrdersSpedizIsrt")
            qm!iNUMERO_DOC_ORD = rst![NUMERO_DOC_ORD]
            qm!iRIGA_DOC_ORD = rst![RIGA_DOC_ORD]
            qm!iUpdateDate = Format(Date, "mm/dd/yyyy")
            qm.Execute
            rst.MoveNext
            ' Aggiorna lo Status Meter
            sngPercento = intI / (intMassimo / 100)
            If sngPercento >= 1 Then
                Call acbUpdateMeter(Int(sngPercento))
            End If
            intI = intI + 1
        Loop
        rst.Close
        Set rst = Nothing
        'Close lo Status Meter
        Call acbCloseMeter

        ' *** Inizia caricamento GIACENZA ITALIA-SP ***
        'Visualizza lo Status Meter
        Call acbInitMeter("IN STOCK ITALY-SP DATA from ORACLE", True)
        'Reset lo Status Meter
        intI = 0
        sngPercento = 0
        ' Cancella dati
        conn.Execute "Delete * From tblOnHandsSp"
        ' Per Usa usato (qt_giac - qt_IMP) perchè facciamo vedere solo disponibile
        ' 20151028  was: "AND tb_ubic IN ('SATT', 'SAUT', 'SDIR', 'XFGB', 'XFPL') "
        MyQuery = "SELECT CD_ART, SUM (qt_giac) as DISP " & _
                  "FROM grp.mag_articolo " & _
                  "WHERE QT_GIAC > 0 " & _
                  "AND cd_soc = ' SP' " & _
                  "AND tb_ubic IN ('SATT', 'SAUT', ' COL') " & _
                  "GROUP BY CD_ART "
        Set rst = Db.OpenRecordset(MyQuery, dbOpenSnapshot, dbSQLPassThrough)
        ' Numero Transazioni
        rst.MoveLast
        intMassimo = rst.RecordCount
        rst.MoveFirst
        
        Do While Not rst.EOF
            Set qm = db0.QueryDefs("qryOnHandsSpIsrt")
            qm!iCOD_ART = rst![Cd_Art]
            qm!iDisp = rst![DISP]
            qm!iUpdateDate = Format(Date, "mm/dd/yyyy")
            qm.Execute
            rst.MoveNext
            ' Aggiorna lo Status Meter
            sngPercento = intI / (intMassimo / 100)
            If sngPercento >= 1 Then
                Call acbUpdateMeter(Int(sngPercento))
            End If
            intI = intI + 1
        Loop
        rst.Close
        'Close lo Status Meter
        Call acbCloseMeter
        ' db.Close

        ' *** Inizia caricamento GIACENZA ITALIA-STEFANI ***
        'Visualizza lo Status Meter
        Call acbInitMeter("IN STOCK ITALY-STEFANI DATA from ORACLE", True)
        'Reset lo Status Meter
        intI = 0
        sngPercento = 0
        ' Cancella dati
        conn.Execute "Delete * From tblOnHandsStefani"
        MyQuery = "SELECT CD_ART, SUM (qt_giac - qt_IMP) AS DISP " & _
                  "FROM AH.MAG_ARTICOLO " & _
                  "WHERE (QT_GIAC - QT_IMP) > 0 " & _
                  "AND tb_ubic like 'SA%' " & _
                  "GROUP BY CD_ART "
        Set rst = Db.OpenRecordset(MyQuery, dbOpenSnapshot, dbSQLPassThrough)
        ' Numero Transazioni
        rst.MoveLast
        intMassimo = rst.RecordCount
        rst.MoveFirst
        
        Do While Not rst.EOF
            Set qm = db0.QueryDefs("qryOnHandsStefaniIsrt")
            qm!iCOD_ART = rst![Cd_Art]
            qm!iDisp = rst![DISP]
            qm!iUpdateDate = Format(Date, "mm/dd/yyyy")
            qm.Execute
            rst.MoveNext
            ' Aggiorna lo Status Meter
            sngPercento = intI / (intMassimo / 100)
            If sngPercento >= 1 Then
                Call acbUpdateMeter(Int(sngPercento))
            End If
            intI = intI + 1
        Loop
        rst.Close
        'Close lo Status Meter
        Call acbCloseMeter


        ' Inserisco tblCOrders in tblArticoli ***
        Dim bqry As DAO.QueryDef
        Dim brs As DAO.Recordset
        Dim qr1 As QueryDef
        Dim qr2 As QueryDef

        'Visualizza lo Status Meter
        Call acbInitMeter("1 CARICO ANAGRAFICHE ARTICOLO 1 - Ordini", True)
        'Reset lo Status Meter
        intI = 0
        sngPercento = 0
        ' Cancella tblArticoliCOrdersUnique
        conn.Execute "Delete * From tblArticoliCOrdersUnique"
        ' Crea tabella tblArticoliCOrdersUnique
        MyQuery = "SELECT DISTINCT tblCOrders.COD_ART, tblCOrders.DESCRIZIONE, " & _
                  "tblCOrders.LEAD_TIME, tblCOrders.ROP, tblCOrders.MAX_MINMAX_QUANTITY, " & _
                  "tblCOrders.ROQ, tblCOrders.MAXIMUM_ORDER_QUANTITY, tblCOrders.CS_CSC  " & _
                  "FROM tblCOrders;"
        Set rst = db0.OpenRecordset(MyQuery, dbOpenSnapshot, dbSQLPassThrough)
        ' Numero Transazioni
        rst.MoveLast
        intMassimo = rst.RecordCount
        rst.MoveFirst
        
        Do While Not rst.EOF
            Set qm = db0.QueryDefs("qryArtCordersUniqueIsrt")
            qm!iCOD_ART = rst![Cod_art]
            qm!iDESCRIZIONE = rst![Descrizione]
            qm!iLEAD_TIME = rst![Lead_time]
            qm!iROP = rst![ROP]
            qm!iMAX_MINMAX_QUANTITY = rst![MAX_MINMAX_QUANTITY]
            qm!iROQ = rst![ROQ]
            qm!iMAXIMUM_ORDER_QUANTITY = rst![MAXIMUM_ORDER_QUANTITY]
            qm!iCS_CSC = rst![Cs_Csc]
            qm.Execute
            rst.MoveNext
            ' Aggiorna lo Status Meter
            sngPercento = intI / (intMassimo / 100)
            If sngPercento >= 1 Then
                Call acbUpdateMeter(Int(sngPercento))
            End If
        Loop
        rst.Close
        Call acbCloseMeter

        'Visualizza lo Status Meter
        Call acbInitMeter(" 2 CARICO ANAGRAFICHE ARTICOLO - Ordini", True)
        'Reset lo Status Meter
        intI = 0
        sngPercento = 0
        ' Crea tabella nuovi articoli
        Set bqry = db0.QueryDefs("qryArticoliImportCOrders")
        Set brs = bqry.OpenRecordset
        
        Do While Not brs.EOF
            Set qr1 = db0.QueryDefs("qryImportSpeditoIsrt")
            qr1!iCOD_ART = brs![Cod_art]
            qr1!iDES_ART = brs![Descrizione]
            qr1!iLEAD_TIME = brs![Lead_time]
            qr1!iROP = brs![ROP]
            qr1!iMAX_MINMAX_QUANTITY = brs![MAX_MINMAX_QUANTITY]
            qr1!iROQ = brs![ROQ]
            qr1!iMAXIMUM_ORDER_QUANTITY = brs![MAXIMUM_ORDER_QUANTITY]
            qr1!iCS_CSC = brs![Cs_Csc]
            qr1.Execute
            Set qr2 = db0.QueryDefs("qryArticoliSegnalazioniIsrt")
            qr2!iCOD_ART = brs![Cod_art]
            qr2!iUser = "System"
            qr2!IComments = "Nuovo Codice"
            qr2!iDate = Format(Date, "mm/dd/yyyy")
            qr2.Execute
            brs.MoveNext
         ' Aggiorna lo Status Meter
            sngPercento = intI / (intMassimo / 100)
            If sngPercento >= 1 Then
                Call acbUpdateMeter(Int(sngPercento))
            End If
            intI = intI + 1
        Loop
        'Close lo Status Meter
        Call acbCloseMeter
        brs.Close
    End If
Exit_cmdImportDataOracle_Click:
    Exit Sub

Err_cmdImportDataOracle_Click:
    MsgBox Err.Description
    Resume Exit_cmdImportDataOracle_Click
End Sub
Public Sub cmdCancel_Click()
' Done - close
    DoCmd.Close acForm, Me.name
End Sub

Private Sub cmdImportOrdiniStorico_Click()
' ==== Importa via ODBC i dati da Oracle  ========
    Dim ws As Workspace
    Dim Db As Database
    Dim db0 As Database    ' ******* DATA BASE CORRENTE ***********
    Dim Lconnect As String
    Dim MyQuery As String
    Dim qm As QueryDef
    Dim rst As Object
    Dim rs As Recordset
    Dim Response As Integer
    Dim conn As ADODB.Connection
    Dim intI As Double
    Dim TotRecord As Double
    ' Verificare i Dim
    Dim FromDate As Variant, ToDate As Variant
    Dim StartDate As Variant, EndDate As Variant
    Dim DatiGen As New ADODB.Recordset
    Dim sngPercento As Single
    ' Dim CatEventi As New adodb.Recordset
    ' Dim CalMag As New adodb.Recordset
    ' Dim CalGiac As New adodb.Recordset
    Dim Art As DAO.Recordset
    Dim Cmd As New ADODB.Command
    Dim bqry As DAO.QueryDef
    Dim brs As DAO.Recordset
    Dim intMassimo As Integer

    On Error GoTo Err_cmdImportDataOracle_Click:

    Response = MsgBox("Vuoi importare gli ORDINI DI VENDITA? ", vbYesNo, "Continue")
    If Response = vbYes Then

        Set db0 = CurrentDb
        Set conn = CurrentProject.Connection
        'memorizzo il periodo di partenza ed il numero di mesi per calcolo media consumi
        DatiGen.Open "tblDatiGeneraliOrdini", conn, adOpenKeyset, adLockOptimistic
        'memorizzo il periodo di partenza ed il numero di mesi per calcolo media consumi
        FromDate = DatiGen.Fields("FromDate")
        StartDate = Format(FromDate, "dd/mmm/yyyy")
        ToDate = DatiGen.Fields("ToDate")
        EndDate = Format(ToDate, "dd/mmm/yyyy")
        Dim qr1 As QueryDef
        DatiGen.Close

        Response = MsgBox("Il periodo di caricamento dati è dal " & FromDate & _
                          " al " & ToDate & " PER MODIFICARE ESCI E LANCIA FORM DATI GENERALI", _
                          vbYesNo, "Continua")
        If Response = vbYes Then
            ' Aggiorna tblRifCalcolo
            Cmd.ActiveConnection = conn

            'Aggiorna la data di ins. Dati SPOSTARE ALLA FINE
            db0.Execute "UPDATE tblDatiGeneraliOrdini SET UpdateDate = #" & Format(Date, _
                                                                                   "mm/dd/yyyy") & "#, " & "UpdateFromDate = #" & Format(FromDate, "mm/dd/yyyy") & "#, " & _
                                                                                   "UpdateToDate = #" & Format(ToDate, "mm/dd/yyyy") & "#", dbFailOnError


            ' *** CONNESSIONE a Oracle

            ' On Error GoTo Err_Execute

            'Use {Microsoft ODBC for Oracle} ODBC connection
            'Lconnect = "ODBC;DSN=sun3000.scmgroup.com;UID=VPERAZZINI;PWD=BIC;SERVER=sun3000.scmgroup.com"
            Lconnect = LeggiOdbcConnect
            'Point to the current workspace
            Set ws = DBEngine.Workspaces(0)

            'Connect to Oracle
            Set Db = ws.OpenDatabase("", False, True, Lconnect)
            ' Setto il tempo di QueryTimeOut a 120 min
            Db.QueryTimeout = 240

            ' **********************************************************************
            ' *** Inizio caricamento ordini_vendita SP STORICO NO TRIANGOLAZIONI ***
            ' **********************************************************************

            ' Cancella dati
            conn.Execute "Delete * From tblCOrdersStorico"

            'Visualizza lo Status Meter
            Call acbInitMeter("IN ORD.CLIENTI ", True)
            'Reset lo Status Meter
            intI = 0
            sngPercento = 0
            ' Cancella dati
            conn.Execute "Delete * From tblCOrdersStorico"
            MyQuery = "SELECT o.societa As soc_ord, soc_sped, " & _
                      "tipo_doc, " & _
                      "numero_doc, " & _
                      "riga_doc, " & _
                      "cod_cli, " & _
                      "ds_rag_soc, " & _
                      "utente, " & _
                      "o.stato,  " & _
                      "liv_urgenza, " & _
                      "data_ordine, " & _
                      "data_prev_cons, " & _
                      "o.cod_art, " & _
                      "descrizione, " & _
                      "grp.get_gg_calendario ('SP', data_ordine, data_prev_cons) AS Giorni_Lt, " & _
                      "flag_stock_out, " & _
                      "qta_ord_umv, " & _
                      "qta_cons_umv, " & _
                      "tipo_riord, " & _
                      "lead_time, " & _
                      "MIN_MINMAX_QUANTITY AS ROP, " & _
                      "MINIMUM_ORDER_QUANTITY AS ROQ, " & _
                      "COSTO_STAND AS CS_CSC, " & _
                      "IMPORTO_NETTO AS IMPORTO_NETTO, " & _
                      "clm, " & _
                "respro "
            MyQuery = MyQuery & "FROM grp.ricorcl o, grp.ricanart a, grp.pd p, GRP.AN_CLIFOR_GRP r " & _
                      "WHERE (o.societa = ' SP' OR soc_sped = ' SP') " & _
                      "AND COD_CLI = cd_clfo(+) " & _
                      "AND data_ordine BETWEEN '" & StartDate & "' AND '" & EndDate & "' " & _
                      "AND TIPO_DOC NOT LIKE '%COMPL MAC%' " & _
                      "AND TIPO_DOC NOT LIKE '%OMAGGI%' " & _
                      "AND TIPO_DOC NOT LIKE '%TRASFERIMENTO%' " & _
                      "AND funz_doc = 'A' " & _
                      "AND o.cod_art = a.cod_art " & _
                      "AND art = a.cod_art " & _
                      "AND soc = ' SP' " & _
                      "AND o.soc_sped = a.societa "



            Set rst = Db.OpenRecordset(MyQuery, dbOpenSnapshot, dbSQLPassThrough)
            ' Numero Transazioni
            rst.MoveLast
            intMassimo = rst.RecordCount
            rst.MoveFirst

            Do While Not rst.EOF
                Set qm = db0.QueryDefs("qryCOrdersStoricoIsrt")
                qm!iSOC_ORD = rst![SOC_ORD]
                qm!iSOC_SPED = rst![SOC_SPED]
                qm!iTIPO_DOC = rst![Tipo_DOC]
                qm!iNUMERO_DOC = rst![NUMERO_DOC]
                qm!iRIGA_DOC = rst![RIGA_DOC]
                qm!iCOD_CLI = rst![COD_CLI]
                qm!iDS_RAG_SOC = rst![DS_RAG_SOC]
                qm!iUTENTE = rst![UTENTE]
                qm!iSTATO = rst![Stato]
                qm!iLIV_URGENZA = rst![liv_urgenza]
                qm!iDATA_ORDINE = rst![DATA_ORDINE]
                qm!iData_Prev_Cons = rst![Data_Prev_Cons]
                qm!iCOD_ART = rst![Cod_art]
                qm!iDESCRIZIONE = rst![Descrizione]
                qm!iGIORNI_LT = rst![Giorni_Lt]
                qm!iFLAG_STOCK_OUT = rst![FLAG_STOCK_OUT]
                qm!iCOD_ART = rst![Cod_art]
                qm!iqta_ord_umv = rst![qta_ord_umv]
                qm!iqta_cons_umv = rst![qta_cons_umv]
                qm!iTIPO_RIORD = rst![TIPO_RIORD]
                qm!iLEAD_TIME = rst![Lead_time]
                qm!iROP = rst![ROP]
                qm!iROQ = rst![ROQ]
                qm!iCS_CSC = rst![Cs_Csc]
                qm!iIMPORTO_NETTO = rst![IMPORTO_NETTO]
                qm!iCLM = rst![CLM]
                qm!iRESPRO = rst![RESPRO]
                qm!iUpdateDate = Format(Date, "mm/dd/yyyy")
                qm.Execute
                rst.MoveNext

                ' Aggiorna lo Status Meter
                sngPercento = intI / (intMassimo / 100)
                If sngPercento >= 1 Then
                    Call acbUpdateMeter(Int(sngPercento))
                End If
                intI = intI + 1
            Loop
            rst.Close
            'Close lo Status Meter
            Call acbCloseMeter
            ' Exit Sub
            ' **********************************************************************
            ' *** Inizio caricamento ordini_vendita SP STORICO  TRIANGOLAZIONI ***
            ' **********************************************************************

            'Visualizza lo Status Meter
            Call acbInitMeter("IN ORD.CLIENTI TRIANGOLAZIONI", True)
            'Reset lo Status Meter
            intI = 0
            sngPercento = 0
            MyQuery = "SELECT o.societa As soc_ord, soc_sped," & _
                      "tipo_doc, " & _
                      "numero_doc, " & _
                      "riga_doc, " & _
                      "cod_cli, " & _
                      "ds_rag_soc, " & _
                      "utente, " & _
                      "o.stato,  " & _
                      "liv_urgenza, " & _
                      "data_ordine, " & _
                      "data_prev_cons, " & _
                      "o.cod_art, " & _
                      "descrizione, " & _
                      "grp.get_gg_calendario ('SP', data_ordine, data_prev_cons) AS Giorni_Lt, " & _
                      "flag_stock_out, " & _
                      "qta_ord_umv, " & _
                      "qta_cons_umv, " & _
                      "tipo_riord, " & _
                      "lead_time, " & _
                      "MIN_MINMAX_QUANTITY AS ROP, " & _
                      "MINIMUM_ORDER_QUANTITY AS ROQ, " & _
                      "COSTO_STAND AS CS_CSC, " & _
                      "IMPORTO_NETTO AS IMPORTO_NETTO, " & _
                      "clm, " & _
                "respro "
            MyQuery = MyQuery & "FROM grp.ricorcl o, grp.ricanart a, grp.pd p, GRP.AN_CLIFOR_GRP r " & _
                      "WHERE o.societa IN ('FD', 'FE', 'FF', 'FGB', 'FOLD', 'FPOL', 'TE') " & _
                      "AND COD_CLI = cd_clfo(+) " & _
                      "AND data_ordine BETWEEN '" & StartDate & "' AND '" & EndDate & "' " & _
                      "AND TIPO_DOC NOT LIKE '%COMPL MAC%' " & _
                      "AND TIPO_DOC NOT LIKE '%OMAGGI%' " & _
                      "AND TIPO_DOC NOT LIKE '%TRASFERIMENTO%' " & _
                      "   AND TIPO_DOC IN" + vbCrLf + _
                      "             ('FD R GARANTIE SCM'," + vbCrLf + _
                      "              'FD RD CNC SCM'," + vbCrLf + _
                      "              'FD RD STD SCM'," + vbCrLf + _
                      "              'FE R SCM'," + vbCrLf + _
                      "              'FF RF SCM'," + vbCrLf + _
                      "              'FF RG CEE SCM'," + vbCrLf + _
                      "              'FGB R WARRANTY SCM'," + vbCrLf + _
                      "              'FGB RG SCM'," + vbCrLf + _
                      "              'FO1 R GARANTIE SCM'," + vbCrLf + _
                      "              'FO1 RN SCM'," + vbCrLf + _
                      "              'FPL R GWARANC. SCM'," + vbCrLf + _
                      "              'FPL RP SCM'," + vbCrLf + _
                      "              'TE RE SCM')"
            MyQuery = MyQuery & "AND funz_doc = 'A' " & _
                      "AND o.cod_art = a.cod_art " & _
                      "AND art = a.cod_art " & _
                      "AND soc = ' SP' " & _
                      "AND o.soc_sped = a.societa "

            Set rst = Db.OpenRecordset(MyQuery, dbOpenSnapshot, dbSQLPassThrough)
            ' Numero Transazioni
            rst.MoveLast
            intMassimo = rst.RecordCount
            rst.MoveFirst

            Do While Not rst.EOF
                Set qm = db0.QueryDefs("qryCOrdersStoricoIsrt")
                qm!iSOC_ORD = rst![SOC_ORD]
                qm!iSOC_SPED = rst![SOC_SPED]
                qm!iTIPO_DOC = rst![Tipo_DOC]
                qm!iNUMERO_DOC = rst![NUMERO_DOC]
                qm!iRIGA_DOC = rst![RIGA_DOC]
                qm!iCOD_CLI = rst![COD_CLI]
                qm!iDS_RAG_SOC = rst![DS_RAG_SOC]
                qm!iUTENTE = rst![UTENTE]
                qm!iSTATO = rst![Stato]
                qm!iLIV_URGENZA = rst![liv_urgenza]
                qm!iDATA_ORDINE = rst![DATA_ORDINE]
                qm!iData_Prev_Cons = rst![Data_Prev_Cons]
                qm!iCOD_ART = rst![Cod_art]
                qm!iDESCRIZIONE = rst![Descrizione]
                qm!iGIORNI_LT = rst![Giorni_Lt]
                qm!iFLAG_STOCK_OUT = rst![FLAG_STOCK_OUT]
                qm!iCOD_ART = rst![Cod_art]
                qm!iqta_ord_umv = rst![qta_ord_umv]
                qm!iqta_cons_umv = rst![qta_cons_umv]
                qm!iTIPO_RIORD = rst![TIPO_RIORD]
                qm!iLEAD_TIME = rst![Lead_time]
                qm!iROP = rst![ROP]
                qm!iROQ = rst![ROQ]
                qm!iCS_CSC = rst![Cs_Csc]
                qm!iIMPORTO_NETTO = rst![IMPORTO_NETTO]
                qm!iCLM = rst![CLM]
                qm!iRESPRO = rst![RESPRO]
                qm!iUpdateDate = Format(Date, "mm/dd/yyyy")
                qm.Execute
                rst.MoveNext

                ' Aggiorna lo Status Meter
                sngPercento = intI / (intMassimo / 100)
                If sngPercento >= 1 Then
                    Call acbUpdateMeter(Int(sngPercento))
                End If
                intI = intI + 1
            Loop
            rst.Close
            'Close lo Status Meter
            Call acbCloseMeter
            'db.Close
            MsgBox "Fine", vbInformation, "IMPORT ORDINI DA ORACLE "

        Else
            Exit Sub
        End If
    End If
Exit_cmdImportDataOracle_Click:
    Exit Sub

Err_cmdImportDataOracle_Click:
    MsgBox Err.Description

    Resume Exit_cmdImportDataOracle_Click

End Sub
