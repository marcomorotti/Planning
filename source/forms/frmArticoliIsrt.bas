Version =20
VersionRequired =20
Begin Form
    DividingLines = NotDefault
    DataEntry = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    TabularCharSet =238
    PictureAlignment =2
    DatasheetGridlinesBehavior =0
    GridY =10
    Width =6292
    DatasheetFontHeight =9
    ItemSuffix =12
    Left =228
    Top =1548
    Right =7056
    Bottom =6204
    RecSrcDt = Begin
        0xd4c266956ee4e340
    End
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            SizeMode =3
            PictureAlignment =2
            Width =1701
            Height =1701
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            Width =1701
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            Width =1701
            Height =1417
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            Width =1701
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin FormHeader
            Height =591
            BackColor =12311007
            Name ="IntestazioneMaschera"
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =30
                    Top =75
                    Width =4200
                    Height =495
                    FontSize =18
                    LeftMargin =22
                    TopMargin =22
                    RightMargin =22
                    BottomMargin =22
                    ForeColor =-2147483615
                    Name ="Auto_Title0"
                    Caption ="Articoli Gestione Manuale"
                    FontName ="Segoe UI"
                    GridlineColor =-2147483616
                    HorizontalAnchor =2
                    LayoutCachedLeft =30
                    LayoutCachedTop =75
                    LayoutCachedWidth =4230
                    LayoutCachedHeight =570
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =5685
                    Width =576
                    Height =576
                    FontSize =8
                    ForeColor =0
                    Name ="cmdClose"
                    Caption ="(demo)"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    Tag ="ShiftLeftNewUnit,ShiftLeftPermLocn"
                    ControlTipText ="Close the form"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5685
                    LayoutCachedWidth =6261
                    LayoutCachedHeight =576
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =83
                    Left =4590
                    Top =15
                    Width =1077
                    Height =360
                    FontSize =9
                    FontWeight =700
                    TabIndex =1
                    ForeColor =255
                    Name ="cmdSave"
                    Caption ="&Save"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ShortcutMenuBar ="Form Control Shortcut Bar"
                    ControlTipText ="Save e Close the window."
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =4590
                    LayoutCachedTop =15
                    LayoutCachedWidth =5667
                    LayoutCachedHeight =375
                End
            End
        End
        Begin Section
            Height =4081
            BackColor =12311007
            Name ="Corpo"
            Begin
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontCharSet =238
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2084
                    Top =345
                    Width =4035
                    Height =359
                    FontWeight =700
                    LeftMargin =22
                    TopMargin =22
                    RightMargin =22
                    BottomMargin =22
                    ForeColor =255
                    Name ="txtID_ArticoliStato"
                    RowGroup =1
                    GroupTable =6

                    LayoutCachedLeft =2084
                    LayoutCachedTop =345
                    LayoutCachedWidth =6119
                    LayoutCachedHeight =704
                    Begin
                        Begin Label
                            Visible = NotDefault
                            OverlapFlags =85
                            TextFontCharSet =238
                            TextAlign =1
                            Left =120
                            Top =345
                            Width =1904
                            Height =359
                            FontWeight =700
                            LeftMargin =22
                            TopMargin =22
                            RightMargin =22
                            BottomMargin =22
                            ForeColor =255
                            Name ="Etichetta1"
                            Caption ="ID_ArticoliStato:"
                            RowGroup =1
                            GroupTable =6
                            LayoutCachedLeft =120
                            LayoutCachedTop =345
                            LayoutCachedWidth =2024
                            LayoutCachedHeight =704
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2084
                    Top =779
                    Width =4035
                    Height =359
                    TabIndex =1
                    LeftMargin =22
                    TopMargin =22
                    RightMargin =22
                    BottomMargin =22
                    Name ="txtCod_Art"
                    RowGroup =2
                    GroupTable =6

                    LayoutCachedLeft =2084
                    LayoutCachedTop =779
                    LayoutCachedWidth =6119
                    LayoutCachedHeight =1138
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =120
                            Top =779
                            Width =1904
                            Height =359
                            LeftMargin =22
                            TopMargin =22
                            RightMargin =22
                            BottomMargin =22
                            ForeColor =-2147483615
                            Name ="Etichetta3"
                            Caption ="Codice Articolo:"
                            RowGroup =2
                            GroupTable =6
                            LayoutCachedLeft =120
                            LayoutCachedTop =779
                            LayoutCachedWidth =2024
                            LayoutCachedHeight =1138
                        End
                    End
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2084
                    Top =2081
                    Width =4035
                    Height =1276
                    TabIndex =4
                    LeftMargin =22
                    TopMargin =22
                    RightMargin =22
                    BottomMargin =22
                    Name ="txtNote"
                    RowGroup =3
                    GroupTable =6

                    LayoutCachedLeft =2084
                    LayoutCachedTop =2081
                    LayoutCachedWidth =6119
                    LayoutCachedHeight =3357
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =120
                            Top =2081
                            Width =1904
                            Height =1276
                            LeftMargin =22
                            TopMargin =22
                            RightMargin =22
                            BottomMargin =22
                            ForeColor =-2147483615
                            Name ="Etichetta7"
                            Caption ="Note:"
                            RowGroup =3
                            GroupTable =6
                            LayoutCachedLeft =120
                            LayoutCachedTop =2081
                            LayoutCachedWidth =2024
                            LayoutCachedHeight =3357
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2084
                    Top =1213
                    Width =4035
                    Height =359
                    TabIndex =2
                    LeftMargin =22
                    TopMargin =22
                    RightMargin =22
                    BottomMargin =22
                    Name ="txtDes_art"
                    RowGroup =5
                    GroupTable =6

                    LayoutCachedLeft =2084
                    LayoutCachedTop =1213
                    LayoutCachedWidth =6119
                    LayoutCachedHeight =1572
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =120
                            Top =1213
                            Width =1904
                            Height =359
                            LeftMargin =22
                            TopMargin =22
                            RightMargin =22
                            BottomMargin =22
                            ForeColor =-2147483615
                            Name ="Etichetta9"
                            Caption ="Descrizione:"
                            RowGroup =5
                            GroupTable =6
                            LayoutCachedLeft =120
                            LayoutCachedTop =1213
                            LayoutCachedWidth =2024
                            LayoutCachedHeight =1572
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2084
                    Top =1647
                    Width =4035
                    Height =359
                    TabIndex =3
                    LeftMargin =22
                    TopMargin =22
                    RightMargin =22
                    BottomMargin =22
                    Name ="txtScortaSicurezzaForzata"
                    RowGroup =4
                    GroupTable =6

                    LayoutCachedLeft =2084
                    LayoutCachedTop =1647
                    LayoutCachedWidth =6119
                    LayoutCachedHeight =2006
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =204
                            TextAlign =1
                            Left =120
                            Top =1647
                            Width =1904
                            Height =359
                            LeftMargin =22
                            TopMargin =22
                            RightMargin =22
                            BottomMargin =22
                            ForeColor =-2147483615
                            Name ="Etichetta11"
                            Caption ="Scorta S Forzata:"
                            RowGroup =4
                            GroupTable =6
                            LayoutCachedLeft =120
                            LayoutCachedTop =1647
                            LayoutCachedWidth =2024
                            LayoutCachedHeight =2006
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="PièDiPaginaMaschera"
            AutoHeight =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Private Sub cmdClose_Click()
     DoCmd.Close acForm, Me.name
End Sub

Public Sub cmdSave_Click()
    Dim strSQL As String
    Dim ScortaSicurezzaForzata As Variant
    Dim cod_exist As Boolean
    ScortaSicurezzaForzata = IIf(IsNull(Me!txtScortaSicurezzaForzata), 0, Me!txtScortaSicurezzaForzata)

    'Controlla che esistano tutti i campi
    ' --- > ctrl Cod_Art
    If IsNothing(Me!txtCod_Art) Then
        MsgBox "Devi inserire il Codice articolo.", vbInformation, gstrAppTitle
        Exit Sub
    End If
    ' --- > ctrl Des_Art
    If IsNothing(Me!txtDes_art) Then
        MsgBox "Devi inserire la descrizione.", vbInformation, gstrAppTitle
        Exit Sub
    End If
    ' --- > ctrl Des_Art
    If IsNothing(Me!txtCod_Art) Then
        MsgBox "Devi inserire il Codice articolo.", vbInformation, gstrAppTitle
        Exit Sub
    End If
' 2016-02-08 Testa se codice esiste
'    Cod_art = DLookup("Cod_Art", "tblArticoliStato", "[Cod_Art] = '" & Me!txtCod_Art & "'")
               
    If IsNull(DLookup("Cod_Art", "tblArticoliStato", "[Cod_Art] = '" & Me!txtCod_Art & "'")) Then

        ' Inserisce tblArticoli
        strSQL = "INSERT INTO tblArticoli ([Cod_Art]," & _
                 "[Des_art], [InsManualmente]) " & _
                 "VALUES ('" & UCase(Me!txtCod_Art) & "'," & _
                 "'" & con(Me!txtDes_art) & "', " & _
                 "'S'" & ")"
        CurrentDb.Execute strSQL, dbFailOnError
   
    ' Inserisce tblArticoliStato
    
    strSQL = "INSERT INTO tblArticoliStato ([Cod_Art]," & _
             "[Note], [ScortaSicurezzaForzata], [DES_ART]) " & _
             "VALUES ('" & Me!txtCod_Art & "'," & _
             "'" & Me!txtNote & "'," & _
             ScortaSicurezzaForzata & ", '" & Me!txtDes_art & "' )"
    CurrentDb.Execute strSQL, dbFailOnError
    Else
    ' Inserisce in tblArticoli
    strSQL = "INSERT INTO tblArticoli ([Cod_Art]," & _
                 "[Des_art], [InsManualmente]) " & _
                 "VALUES ('" & UCase(Me!txtCod_Art) & "'," & _
                 "'" & con(Me!txtDes_art) & "', " & _
                 "'S'" & ")"
        CurrentDb.Execute strSQL, dbFailOnError
    
    MsgBox "Attributi aggiuntivi già esistenti. Verifica i dati ricercando il codice", vbInformation, gstrAppTitle
    End If
    If IsLoaded("frmParts1") Then
        [Forms]![frmParts1].Requery
    End If

    DoCmd.Close acForm, Me.name
End Sub
