Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    CloseButton = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    TabularFamily =0
    BorderStyle =3
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =12120
    DatasheetFontHeight =10
    ItemSuffix =147
    Left =6495
    Top =4125
    Right =18615
    Bottom =6510
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x92de853a1067e240
    End
    Caption =" "
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =0
    AllowLayoutView =0
    DatasheetGridlinesColor12 =12632256
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            SpecialEffect =3
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            FontName ="Tahoma"
            AsianLineBreak =255
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            SpecialEffect =2
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ComboBox
            SpecialEffect =2
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Subform
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Section
            CanGrow = NotDefault
            Height =2400
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =2
                    Left =105
                    Top =120
                    Width =11895
                    Height =420
                    FontSize =14
                    FontWeight =700
                    BackColor =0
                    ForeColor =16777164
                    Name ="Label0"
                    Caption ="Importa Articoli Obsoleti"
                    FontName ="Arial"
                    LayoutCachedLeft =105
                    LayoutCachedTop =120
                    LayoutCachedWidth =12000
                    LayoutCachedHeight =540
                End
                Begin Rectangle
                    SpecialEffect =0
                    BorderWidth =2
                    OverlapFlags =223
                    Left =60
                    Top =60
                    Width =12000
                    Height =2280
                    BorderColor =128
                    Name ="Box74"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =215
                    AccessKey =67
                    Left =10980
                    Top =180
                    Width =960
                    Height =300
                    FontWeight =700
                    ForeColor =128
                    Name ="cmdCloseF"
                    Caption ="&Close"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    UnicodeAccessKey =67

                End
                Begin TextBox
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =215
                    TextAlign =1
                    Left =2820
                    Top =960
                    Width =7200
                    Height =300
                    FontSize =10
                    TabIndex =2
                    BackColor =10079487
                    Name ="txtFileObsoleti"
                    ConditionalFormat = Begin
                        0x01000000ae000000010000000100000000000000000000002600000001000000 ,
                        0x00000000ff000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x490073004e0075006c006c00280046006f0072006d0073002100520065007000 ,
                        0x6f007200740046006f0072006d0021004500780070006f007200740046006f00 ,
                        0x6c00640065007200290000000000
                    End

                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =3
                            Left =480
                            Top =960
                            Width =2280
                            Height =300
                            FontSize =10
                            Name ="Label112"
                            Caption ="File da Importare:"
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =3660
                    Top =1440
                    Width =5340
                    Height =420
                    FontSize =12
                    FontWeight =700
                    TabIndex =4
                    ForeColor =0
                    Name ="cmdImportData"
                    Caption ="Import file nella tblArticoliObsoletiTemp"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"

                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    RowSourceTypeInt =1
                    SpecialEffect =0
                    BorderWidth =1
                    OverlapFlags =215
                    TextAlign =2
                    BackStyle =0
                    Left =6060
                    Top =600
                    Width =1140
                    Height =300
                    FontSize =11
                    TabIndex =1
                    BackColor =10092543
                    Name ="vType"
                    RowSourceType ="Value List"
                    RowSource ="csv;xls;dbase"
                    DefaultValue ="=\"xls\""

                    Begin
                        Begin Label
                            OverlapFlags =215
                            TextAlign =3
                            Left =4380
                            Top =600
                            Width =1620
                            Height =300
                            FontSize =11
                            Name ="Label120"
                            Caption ="Import Tipo:"
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =215
                    AccessKey =66
                    TextFontFamily =18
                    Left =10080
                    Top =960
                    Width =960
                    FontSize =10
                    FontWeight =700
                    TabIndex =3
                    ForeColor =0
                    Name ="cmdBrowse"
                    Caption ="&Browse"
                    OnClick ="[Event Procedure]"
                    FontName ="Times New Roman"

                End
                Begin Label
                    OverlapFlags =215
                    Left =7260
                    Top =660
                    Width =1620
                    Height =240
                    Name ="Label137"
                    Caption ="(locked - edit in code)"
                End
                Begin CheckBox
                    OverlapFlags =215
                    Left =9300
                    Top =660
                    Width =240
                    TabIndex =5
                    Name ="HasHeader"
                    DefaultValue ="=True"

                    LayoutCachedLeft =9300
                    LayoutCachedTop =660
                    LayoutCachedWidth =9540
                    LayoutCachedHeight =900
                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =9530
                            Top =615
                            Width =1620
                            Height =255
                            Name ="Label139"
                            Caption ="Files Have Header"
                            LayoutCachedLeft =9530
                            LayoutCachedTop =615
                            LayoutCachedWidth =11150
                            LayoutCachedHeight =870
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =215
                    AccessKey =79
                    TextFontFamily =18
                    Left =11078
                    Top =1133
                    Width =900
                    Height =660
                    FontSize =10
                    FontWeight =700
                    TabIndex =6
                    ForeColor =0
                    Name ="cmdOpenLinked"
                    Caption ="&Open File XLS"
                    OnClick ="[Event Procedure]"
                    FontName ="Times New Roman"
                    UnicodeAccessKey =79

                    LayoutCachedLeft =11078
                    LayoutCachedTop =1133
                    LayoutCachedWidth =11978
                    LayoutCachedHeight =1793
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =11612
                    Top =614
                    Width =366
                    Height =411
                    FontSize =9
                    FontWeight =700
                    TabIndex =7
                    ForeColor =10040115
                    Name ="cmdHelp"
                    Caption ="Help"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Composizione automatica"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =11612
                    LayoutCachedTop =614
                    LayoutCachedWidth =11978
                    LayoutCachedHeight =1025
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Private Sub cmdCancel_Click()
DoCmd.Close
End Sub
Private Sub cmdBrowse_Click()
 Dim Indirizzo As String
    Dim PackingList As String
    Dim Db As Database
    Dim tb As Recordset
    Dim rs As Recordset
    Dim qr As QueryDef
    Dim Risp As Integer
    Dim vado As Boolean
    Dim qm As QueryDef
    Dim ElimC As Recordset
    Dim strPath As String
    Dim strSQL As String
    
    ' Chiama una copia di Office file dialog
    Const msoFileDialogFilePicker = 3
    With Application.FileDialog(msoFileDialogFilePicker)
        ' Seleziona solo un file
        .AllowMultiSelect = False
        ' Set il titolo del dialogo
        .Title = "SELEZIONA IL DIRETTORIO DEL FILE EXCEL DA IMPORTARE"
        ' Set the button caption
        .ButtonName = "Choose"
        ' Make sure the filter list is clear
        .Filters.Clear
        ' Add two filters
        .Filters.Add "Excel", "*.xls"
        ' Set the filter index to 1
        .FilterIndex = 1
        ' Set the initial path name
        .InitialFileName = CurrentProject.Path & "\"
        ' Show files as thumbnails
        ' '''.InitialView = msoFileDialogViewThumbnail
        ' Show the dialog and test the return
        If .Show = 0 Then
            ' Didn't pick a file - bail
            Exit Sub
        End If
        ' Should be only one filename - grab it
        strPath = Trim(.SelectedItems(1))
        ' Set an error trap
        On Error Resume Next
        ' Voglio essere sicuro che sia tutto a posto
        If Err = 0 Then
            
'            If left(strPath, Len(CurrentProject.Path)) = CurrentProject.Path Then
'                ' Strip it off and store a relative path
'                strPath = Mid(strPath, Len(CurrentProject.Path) + 2)
'            End If
'            ' Set the path in the record
            'Indirizzo = CurrentProject.Path & "\" & strPath
            Indirizzo = strPath
            Me.txtFileObsoleti = Indirizzo
            Else
            ' OOOps.
            ' Set the message
            MsgBox ("Errore toIMPORT - Il file deve essere salvato in formato XLS" _
                    & strWrkBkName)
            
        End If
    End With
End Sub
Private Sub cmdCloseF_Click()
DoCmd.Close
End Sub

Private Sub cmdHelp_Click()
Dim FormHelpId As Long
Dim curForm As Form
     'Set the curForm variable to the currently active form.
    Set curForm = Screen.ActiveForm
    FormHelpId = 490
    'Call the function to start the Help file, passing it the name of the
    'Help file and context-id.
    Show_Help FormHelpFile, FormHelpId
End Sub

Private Sub cmdImportData_Click()
Dim strSQL As String
Dim QI As Integer
Dim HasHeader As Boolean
QI = MsgBox("Confermi che vuoi aggiornare gli art. obsoleti? : ", vbYesNo)
If QI = vbNo Then Exit Sub
FileObsoleti = Me.txtFileObsoleti.Value
HasHeader = Forms!frmImport!HasHeader
If IsNull(Me!txtFileObsoleti) Or Me!txtFileObsoleti = "" Then
    MsgBox "Devi scegliere un file prima!"
    Me.cmdBrowse.SetFocus
    Exit Sub
Else
        ' Cancella dati dalla tabella temporanea tblArticoliObsoletiImport e carica file Excel
        ImportaFile FileObsoleti, "tblArticoliObsoletiImport", HasHeader
        ' Aggiorna tabella
        strSQL = "INSERT INTO tblArticoliStato " & _
        "SELECT tblArticoliObsoletiImport.OLD_COD AS COD_ART, 4 AS ID_StatoArticolo, " & _
        "tblArticoliObsoletiImport.NOTE & Chr(13) & Chr(10) & 'Migrato da eBS " & Date & "'" & " AS [NOTE], " & _
        "tblArticoliObsoletiImport.NEW_COD AS Cod_Art_Correlato, tblArticoliObsoletiImport.LAST_UPDATE_DATE AS Data_Modifica, " & _
        "0 as ScortaSicurezzaForzata, " & _
        "tblArticoliObsoletiImport.DES_ART " & _
        "From tblArticoliObsoletiImport " & _
        "WHERE (((Exists (select Cod_Art " & _
        "From tblArticoliStato " & _
        "where tblArticoliStato.Cod_art = tblArticoliObsoletiImport.OLD_COD))=False));"

CurrentDb.Execute strSQL, dbFailOnError
MsgBox "Importazione Terminata"
DoCmd.Close acForm, "frmImport"
End If
End Sub

Private Sub cmdOpenLinked_Click()
If IsNull(Me!txtFileObsoleti) Then
    MsgBox "Seleziona un file prima."
    Exit Sub
End If
Shell "C:\WINDOWS\explorer.exe """ & Me!txtFileObsoleti & "", vbNormalFocus
End Sub
