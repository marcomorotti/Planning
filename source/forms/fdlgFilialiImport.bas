Version =20
VersionRequired =20
Begin Form
    AllowEditing = NotDefault
    PopUp = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    AllowAdditions = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularFamily =0
    BorderStyle =3
    Width =6006
    ItemSuffix =29
    Left =7200
    Top =2925
    Right =13200
    Bottom =4800
    RecSrcDt = Begin
        0xed312f5baf8be140
    End
    Caption ="Import Data & export 2 Excel..."
    PrtMip = Begin
        0xd0020000a0050000d0020000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =0
    AllowLayoutView =0
    Begin
        Begin Label
            BackStyle =0
            TextAlign =3
            FontWeight =700
            BackColor =-2147483633
            FontName ="Arial"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            SizeMode =3
            PictureAlignment =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontName ="Arial"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            AddColon = NotDefault
            SpecialEffect =2
            LabelAlign =3
            Width =187
            Height =187
            LabelX =-146
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            AddColon = NotDefault
            SpecialEffect =2
            LabelAlign =3
            Width =187
            Height =187
            LabelX =-146
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            SpecialEffect =3
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            SpecialEffect =2
            LabelAlign =3
            TextFontFamily =0
            LabelX =-146
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            SpecialEffect =2
            LabelAlign =3
            TextFontFamily =0
            LabelX =-146
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ComboBox
            SpecialEffect =2
            LabelAlign =3
            TextFontFamily =0
            LabelX =-146
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Subform
            AutoLabel = NotDefault
            AddColon = NotDefault
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            SizeMode =3
            SpecialEffect =2
            OldBorderStyle =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin FormHeader
            Height =577
            BackColor =12632256
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =93
                    TextAlign =1
                    Left =29
                    Top =29
                    Width =2550
                    Height =390
                    FontSize =14
                    ForeColor =16777215
                    Name ="Label0"
                    Caption ="Invoice Search"
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =1
                    Width =3570
                    Height =390
                    FontSize =14
                    Name ="Label11"
                    Caption ="Giacenze Consumi Filiale"
                    LayoutCachedWidth =3570
                    LayoutCachedHeight =390
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =5188
                    Width =576
                    Height =576
                    FontSize =8
                    FontWeight =400
                    Name ="cmdExit"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    Tag ="ShiftLeftNewUnit,ShiftLeftPermLocn"
                    ControlTipText ="Close the form"

                    LayoutCachedLeft =5188
                    LayoutCachedWidth =5764
                    LayoutCachedHeight =576
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =88
                    Left =4611
                    Width =577
                    Height =577
                    TabIndex =1
                    Name ="cmdExcel"
                    Caption ="E&xcel"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Export ..."
                    UnicodeAccessKey =120
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000030000000b00000014000000190000001d ,
                        0x000000230000002a000000320000003800000040000000470000004c0000003b ,
                        0x0000002700000005000000000000001000000020000000400000005000000050 ,
                        0x4040407060686080a0a0a0a0b0b0b0b0c0c8c0c0d0e0e0e0e0f0e0f0d0d8d0c0 ,
                        0x0000004000000020106010c0105810d080a080f0c0d0c0f0d0e0d0ffffffffff ,
                        0xfffffffffffffffff0fffffff0fffffff0fffffff0fffffff0fff0ffc0d8c0f0 ,
                        0x0000004000000020106010f0a0b8a0ffc0d0c0ffffffffffffffffffffffffff ,
                        0xfffffffff0fffffff0ffffff90c0a0ff107030ff107030fff0f8f0ffe0e8e0ff ,
                        0x0000004000000020106810f0b0d0c0ff80a080ffffffffffc0e0c0ff80c080ff ,
                        0x70b870ff70b870ff60b070ff107030ff107030ff60a870ffe0f0e0fff0f8f0ff ,
                        0x0000004000000020106810f0c0d0c0ff407840ffffffffffffffffffc0e0c0ff ,
                        0x70b870ff70b870ff208040ff107030ff60a070ff60b070ffa0d0a0fff0ffffff ,
                        0x4040406000000020107010f0c0d0c0ff206020fff0f0f0ffffffffffffffffff ,
                        0xe0f0e0ff409860ff107030ff207840ffb0e0c0fffffffffff0fffffff0ffffff ,
                        0x7070707000000020207020f0c0d0c0ff206020ffb0c8b0ffffffffffffffffff ,
                        0xc0d8d0ff107030ff107030ff60a860ff70b870ffa0d0a0fff0fff0fff0ffffff ,
                        0x9098909000000020207820f0c0d0c0ff206820ff90a890fffffffffff0f8f0ff ,
                        0x107030ff107030ff90c0a0ffe0f0e0ff70b870ff70b870ff90c890fff0f8f0ff ,
                        0xb0b0b0a000000020207820f0d0e0d0ff70a870ff90b090ffffffffff409060ff ,
                        0x308050ff60a070ffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xd0d0d0a000000020208020f0d0e8d0ff80b880ff80b080ffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xf0f0f0b000000020208020e0d0e8d0ffa0c8a0ff80b880ffd0e8d0ffd0e0d0ff ,
                        0xd0e0d0ffd0e0d0ffc0d8c0ffb0d8b0ffa0d0a0ff90c8a0ffd0e8d0ff50a050e0 ,
                        0xffffff2000000000208020a0a0c890ffe0f0e0ff90c890ff90c890ff90c890ff ,
                        0x90c890ff90c890ff90c890ff90c890ff90c890ff90c890fff0f8f0ff208020d0 ,
                        0x000000000000000030882030308820ffc0e0c0fff0f8f0ffb0d8b0ffa0d0a0ff ,
                        0xa0d0a0ffa0d0a0ffa0d0a0ffa0d0a0ffa0d0a0ff90d0a0fff0f8f0ff308820d0 ,
                        0x00000000000000000000000030882060308820f090c890ffd0e8d0fff0f8f0ff ,
                        0xf0f8f0fff0f8f0fff0f8f0fff0f8f0fff0f8f0fff0f8f0fff0f8f0ff308820d0 ,
                        0x0000000000000000000000000000000030902020309020a0309020e0309020ff ,
                        0x309020ff309020ff309020ff309020ff309020ff309020ff309020ff309020d0 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =4611
                    LayoutCachedWidth =5188
                    LayoutCachedHeight =577
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =4035
                    Width =576
                    Height =576
                    FontSize =8
                    FontWeight =400
                    TabIndex =2
                    Name ="cmdApriDir"
                    Caption ="(demo)"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    Tag ="ShiftLeftNewUnit,ShiftLeftPermLocn"
                    ControlTipText ="Apre direttorio export"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000708890ff608090ff607880ff507080ff506070ff405860ff ,
                        0x404850ff303840ff203030ff202030ff101820ff101010ff101020ff00000000 ,
                        0x0000000000000000708890ff90a0b0ff70b0d0ff0090d0ff0090d0ff0090d0ff ,
                        0x0090c0ff1088c0ff1080b0ff1080b0ff2078a0ff207090ff204860ff20303050 ,
                        0x0000000000000000808890ff80c0d0ff90a8b0ff80e0ffff60d0ffff50c8ffff ,
                        0x50c8ffff40c0f0ff30b0f0ff30a8f0ff20a0e0ff1090d0ff206880ff202830b0 ,
                        0x00000000000000008090a0ff80d0f0ff90a8b0ff90c0d0ff70d8ffff60d0ffff ,
                        0x60d0ffff50c8ffff50c0ffff40b8f0ff30b0f0ff30a8f0ff1088d0ff204860ff ,
                        0x10283020000000008090a0ff80d8f0ff80c8e0ff90a8b0ff80e0ffff70d0ffff ,
                        0x60d8ffff60d0ffff60d0ffff50c8ffff40c0f0ff40b8f0ff30b0f0ff206880ff ,
                        0x10486090000000008098a0ff90e0f0ff90e0ffff90a8b0ff90b8c0ff70d8ffff ,
                        0x60d8ffff60d8ffff60d8ffff60d0ffff50d0ffff50c8ffff40b8f0ff30a0e0ff ,
                        0x406070f0506070308098a0ff90e0f0ffa0e8ffff80c8e0ff90a8b0ff80e0ffff ,
                        0x80e0ffff80e0ffff80e0ffff80e0ffff80e0ffff80e0ffff70d8ffff70d8ffff ,
                        0x50a8d0ff506070a090a0a0ffa0e8f0ffa0e8ffffa0e8ffff90b0c0ff90b0c0ff ,
                        0x90a8b0ff90a8b0ff80a0b0ff80a0b0ff8098a0ff8098a0ff8090a0ff8090a0ff ,
                        0x808890ff708890ff90a0b0ffa0e8f0ffa0f0ffffa0e8ffffa0e8ffff80d8ffff ,
                        0x60d8ffff60d8ffff60d8ffff60d8ffff60d8ffff60d8ffff708890ff00000000 ,
                        0x000000000000000090a0b0ffa0f0f0ffb0f0f0ffa0f0ffffa0e8ffffa0e8ffff ,
                        0x70d8ffff90a0a0ff8098a0ff8098a0ff8090a0ff809090ff708890ff00000000 ,
                        0x000000000000000090a8b0ffa0d0e0ffb0f0f0ffb0f0f0ffa0f0ffffa0e8ffff ,
                        0x90a0b0ff80a8b0800000000000000000000000000000000000000000906850ff ,
                        0x906850ff906850ff90a8b05090a8b0ff90a8b0ff90a8b0ff90a8b0ff90a8b0ff ,
                        0x90a8b090000000000000000000000000000000000000000000000000a0787050 ,
                        0x906850ff906850ff000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000907860ff9068506000000000a0787010a09080ff ,
                        0xa0887050907860ff000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000a0988040a09080ffa08880ffb09880ffa0908080 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =4035
                    LayoutCachedWidth =4611
                    LayoutCachedHeight =576
                End
            End
        End
        Begin Section
            Height =1322
            BackColor =12632256
            Name ="Detail0"
            Begin
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    ColumnCount =3
                    ListWidth =4680
                    Left =2186
                    Top =540
                    Width =3780
                    FontSize =10
                    BoundColumn =2
                    BorderColor =1
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"60\""
                    Name ="txtFiliale"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tblFiliale.* FROM tblFiliale ORDER BY tblFiliale.Sequenza; "
                    ColumnWidths ="0;1134"
                    StatusBarText ="Company / Organization"
                    OnNotInList ="[Event Procedure]"
                    ShortcutMenuBar ="Form Control Shortcut Bar"

                    LayoutCachedLeft =2186
                    LayoutCachedTop =540
                    LayoutCachedWidth =5966
                    LayoutCachedHeight =780
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =162
                            Left =1110
                            Top =555
                            Width =975
                            Height =255
                            FontSize =10
                            Name ="Label2"
                            Caption ="Filiale:"
                            LayoutCachedLeft =1110
                            LayoutCachedTop =555
                            LayoutCachedWidth =2085
                            LayoutCachedHeight =810
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =2186
                    Top =96
                    Width =1275
                    Height =300
                    FontSize =10
                    TabIndex =1
                    BorderColor =1
                    Name ="txtMovimentoFrom"
                    Format ="dd/mm/yyyy"
                    StatusBarText ="Contact Date From"
                    OnDblClick ="[Event Procedure]"
                    ShortcutMenuBar ="Form Control Shortcut Bar"
                    ControlTipText ="Double-click to pick a date."

                    LayoutCachedLeft =2186
                    LayoutCachedTop =96
                    LayoutCachedWidth =3461
                    LayoutCachedHeight =396
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =162
                            Left =60
                            Top =135
                            Width =2025
                            Height =255
                            FontSize =10
                            Name ="Label17"
                            Caption ="Data Movimenti  Da:"
                            LayoutCachedLeft =60
                            LayoutCachedTop =135
                            LayoutCachedWidth =2085
                            LayoutCachedHeight =390
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontFamily =2
                    Left =3525
                    Top =135
                    Width =246
                    Height =246
                    TabIndex =2
                    Name ="cmdOrderFromCal"
                    Caption ="C"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadada000000000000000d0fffffffffffff0a ,
                        0x0f7777777fffff0d0f7f7f7f7fffff0a0f77777777777f0d0f7f7f7f7f7f7f0a ,
                        0x0f77777777777f0d0f7f7f7f7f7f7f0a0f77777777777f0d0f7f7f7f7f7f7f0a ,
                        0x0f77777777777f0d0fffffffffffff0a0f777777fff77f0d0fffffffffffff0a ,
                        0x000000000000000d
                    End
                    FontName ="System"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ShortcutMenuBar ="Form Control Shortcut Bar"

                    LayoutCachedLeft =3525
                    LayoutCachedTop =135
                    LayoutCachedWidth =3771
                    LayoutCachedHeight =381
                End
                Begin TextBox
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =4425
                    Top =90
                    Width =1275
                    Height =300
                    FontSize =10
                    TabIndex =3
                    BorderColor =1
                    Name ="txtMovimentoTo"
                    Format ="dd/mm/yyyy"
                    StatusBarText ="Contact Date To"
                    OnDblClick ="[Event Procedure]"
                    ShortcutMenuBar ="Form Control Shortcut Bar"
                    ControlTipText ="Double-click to pick a date."

                    LayoutCachedLeft =4425
                    LayoutCachedTop =90
                    LayoutCachedWidth =5700
                    LayoutCachedHeight =390
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =162
                            Left =3915
                            Top =135
                            Width =450
                            Height =225
                            FontSize =10
                            Name ="Label18"
                            Caption ="A:"
                            LayoutCachedLeft =3915
                            LayoutCachedTop =135
                            LayoutCachedWidth =4365
                            LayoutCachedHeight =360
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontFamily =2
                    Left =5760
                    Top =141
                    Width =246
                    Height =246
                    TabIndex =4
                    Name ="cmdOrderToCal"
                    Caption ="C"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadada000000000000000d0fffffffffffff0a ,
                        0x0f7777777fffff0d0f7f7f7f7fffff0a0f77777777777f0d0f7f7f7f7f7f7f0a ,
                        0x0f77777777777f0d0f7f7f7f7f7f7f0a0f77777777777f0d0f7f7f7f7f7f7f0a ,
                        0x0f77777777777f0d0fffffffffffff0a0f777777fff77f0d0fffffffffffff0a ,
                        0x000000000000000d
                    End
                    FontName ="System"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ShortcutMenuBar ="Form Control Shortcut Bar"

                    LayoutCachedLeft =5760
                    LayoutCachedTop =141
                    LayoutCachedWidth =6006
                    LayoutCachedHeight =387
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =12632256
            Name ="FormFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit


Private Sub cmdApriDir_Click()
    Call fHandleFile(CurrentProject.Path & "\Export", WIN_NORMAL)
End Sub

Private Sub cmdExit_Click()
    DoCmd.Close acForm, Me.name
End Sub


Private Sub txtFiliale_NotInList(NewData As String, Response As Integer)
    ' Can't pick a non-existent company
    MsgBox "Devi scegliere una FILIALE dalla lista.", vbExclamation, gstrAppTitle
    ' Tell Access we handled the error
    Response = acDataErrContinue
    ' .. and drop down the list
    Me.txtFiliale.Dropdown
End Sub

Public Sub cmdCancel_Click()
    ' Change their mind - close
    DoCmd.Close acForm, Me.name
End Sub

Private Sub cmdOrderFromCal_Click()
Dim varReturn As Variant
    ' Put the focus on the date field
    Me.txtMovimentoFrom.SetFocus
    ' Call the calendar function, date only
    varReturn = GetDate(Me.txtMovimentoFrom, True)

End Sub

Private Sub cmdOrderToCal_Click()
Dim varReturn As Variant
    ' Put the focus on the date field
    Me.txtMovimentoTo.SetFocus
    ' Call the calendar function, date only
    varReturn = GetDate(Me.txtMovimentoTo, True)

End Sub

Private Sub cmdExcel_Click()

    ' First, validate the dates
    ' If there's something in Date From
    If IsNothing(Me.txtMovimentoFrom) Then
        ' First, make sure it's a valid date
           MsgBox "Devi inserire la data di inizio periodo !!!", vbInformation, gstrAppTitle
           Exit Sub
        If Not IsDate(Me.txtMovimentoFrom) Then
            ' Nope, warn them and bail
            MsgBox "The value in Request Date From is not a valid date.", _
                vbCritical, gstrAppTitle
            Exit Sub
        End If
    End If
        ' Now see if they specified a "to" date
    If IsNothing(Me.txtMovimentoTo) Then
            ' First, make sure it's a valid date
            MsgBox "Devi inserire la data di fine periodo !!!", vbInformation, gstrAppTitle
            Exit Sub
        
            If Not IsDate(Me.txtMovimentoTo) Then
                ' Nope, warn them and bail
                MsgBox "The value in Request Date To is not a valid date.", _
                    vbCritical, gstrAppTitle
                Exit Sub
            End If
    End If
            ' Got two dates, now make sure "to" is >= "from"
            
    If Me.txtMovimentoTo < Me.txtMovimentoFrom Then
                MsgBox _
                    "Request To date must be greater than or equal to Request From date.", _
                    vbCritical, gstrAppTitle
                Exit Sub
    Else
            ' No "from" but did they specify a "to"?
            
    End If
    
    
      
    ' Do Filiale
    If IsNothing(Me.txtFiliale) Then
        MsgBox "Devi inserire la FILIALE !!!", vbInformation, gstrAppTitle
        Exit Sub
    End If
    
    ' Lancia estrazione Dati
    ' Fattoooooooooooo Marco Morotti 31/01/2012

' Importa le giacenze e consumi Novorex
Dim ws As Workspace
Dim Db As Database
Dim db0 As Database ' ******* DATA BASE CORRENTE ***********
Dim Lconnect As String
Dim MyQuery As String
Dim qm As QueryDef
Dim qr1 As QueryDef
Dim rst As Object
Dim rs As Recordset
Dim Response, intMassimo As Integer
Dim conn As ADODB.Connection
Dim intI As Double
' Verificare i Dim
Dim intStartDate As Variant, intEndDate As Variant
Dim DatiGen As New ADODB.Recordset

Dim Cmd As New ADODB.Command
Dim bqry As DAO.QueryDef
Dim brs As DAO.Recordset

Dim AnnoC As String
Dim MeseC As String
Dim sngPercento As Single

' Dim nRecords As Integer 'Long
On Error GoTo Err_CmdImportaGiacenzeNovorex_Click:

Response = MsgBox("Vuoi esportare le GIACENZE e i CONSUMI della filiale " & Me.txtFiliale.Column(1), _
    vbYesNo, "Continue")
If Response = vbYes Then

' SETTA VARIABILI DATE SQL
AnnoC = Year(Me.txtMovimentoTo)
MeseC = Month(Me.txtMovimentoTo)
intStartDate = Format(Me.txtMovimentoFrom, "dd/mmm/yyyy")
intEndDate = Format(Me.txtMovimentoTo, "dd/mmm/yyyy")
Set db0 = CurrentDb
Set conn = CurrentProject.Connection
'  GoTo start
' *** CONNESSIONE a Oracle

' On Error GoTo Err_Execute

'Use {Microsoft ODBC for Oracle} ODBC connection
    'Lconnect = _
        "ODBC;DSN=sun3000.scmgroup.com;UID=VPERAZZINI;PWD=BIC;SERVER=sun3000.scmgroup.com"
    ' Lconnect = "ODBC;DSN=Sun3000.scmgroup.com;UID=VPERAZZINI;PWD=BIC;SERVER=Sun3000"
    Lconnect = LeggiOdbcConnect
    'Point to the current workspace
    Set ws = DBEngine.Workspaces(0)
    
    'Connect to Oracle
    Set Db = ws.OpenDatabase("", False, True, Lconnect)
    ' Setto il tempo di QueryTimeOut a 120 min
    Db.QueryTimeout = 240
' ***************************************************************************************************************
' *** Inizio caricamento GIACENZE *******************************************************************************
' ***************************************************************************************************************
    'Visualizza lo Status Meter
    Call acbInitMeter("1-GIACENZE da ORACLE", True)
    'Reset lo Status Meter
    intI = 0
    ' Cancella dati
    conn.Execute "Delete * From tblGiacenzaNovorex"
    
    If Me.txtFiliale = "DA" Or Me.txtFiliale = "AH" Or Me.txtFiliale = "A1" Or Me.txtFiliale = "SP" Then
       MyQuery = "SELECT giacenza.CD_ART AS CD_ART, " & _
                 "grp.ricanart.descr_art AS DESCR_ART, " & _
                 "CD_UM AS UM, " & _
                 "TO_CHAR (SUM (giacenza.qt_giac)) AS QT_GIAC, " & _
                 "TO_CHAR(Cs_Csc) As Cs_Csc " & _
                 "FROM grp.mag_articolo giacenza, grp.AN_ARTICOLO anagrafica, grp.ricanart " & _
                 "WHERE giacenza.cd_soc = ' " & Me.txtFiliale & "' " & _
                 "AND giacenza.cd_soc = anagrafica.CD_SOC " & _
                 "AND giacenza.cd_soc = grp.ricanart.societa " & _
                 "AND giacenza.tb_ubic IN ('SAUT', 'SDIR') " & _
                 "AND giacenza.CD_ART = anagrafica.CD_ART " & _
                 "AND giacenza.CD_ART = grp.ricanart.COD_ART " & _
                 "AND giacenza.qt_giac > 0 " & _
                 "GROUP BY giacenza.CD_ART, grp.ricanart.descr_art, CD_UM, CS_CSC"
    
    Else
    
    MyQuery = "SELECT giacenza.Articolo AS CD_ART, " & _
        "anagrafica.DS_TEC AS DESCR_ART, " & "UM, " & _
        "to_char(SUM (giacenza)) AS QT_GIAC, " & "to_char(csc_grp) As CS_CSC " & _
        "FROM sim.storico_costi_stock_ric giacenza, DB.AN_ARTICOLO_GRP anagrafica, STAT_MMP_DATI_VIEW costi " _
        & "WHERE giacenza.Articolo = anagrafica.CD_ART(+) " & _
        "AND TRIM(org) = '" & Me.txtFiliale & _
        "' " & "AND mese = " & AnnoC & Format(MeseC, "00") & "AND org = costi.societa " & _
        "AND giacenza.Articolo = costi.articolo " & "AND periodo = " & AnnoC & _
        Format(MeseC, "00") & "AND giacenza.Articolo not like '000142996%' " & _
        "AND giacenza > 0 " & _
        "GROUP BY giacenza.Articolo, " & "anagrafica.DS_TEC, " & "UM, " & _
        "csc_grp "
    End If
    
    Set rst = Db.OpenRecordset(MyQuery, dbOpenSnapshot, dbSQLPassThrough)
    Do While Not rst.EOF
       Set qm = db0.QueryDefs("qryGiacenzaNovorexIsrt")
       qm!iCD_ART = rst![Cd_Art]
       qm!iDescr_Art = rst![DESCR_ART]
       qm!iUM = rst![UM]
       qm!iQT_GIAC = rst![qt_giac]
       qm!iCS_CSC = rst![Cs_Csc]
       qm!iUpdateDate = Format(Date, "mm/dd/yyyy")
       qm.Execute
       rst.MoveNext
        ' Aggiorna lo Status Meter
        intI = intI + (1 / 50)
        Call acbUpdateMeter(Int(intI))
    ' Attende un secondo
    DoEvents
    Loop
    'Close lo Status Meter
    Call acbCloseMeter
    rst.Close
' Start:
' ***************************************************************************************************************
' *** Inizio caricamento SPEDITO  *******************************************************************************
' ***************************************************************************************************************

' *** CONNESSIONE a Oracle

'Use {Microsoft ODBC for Oracle} ODBC connection
    'Lconnect = _
        "ODBC;DSN=sun3000.scmgroup.com;UID=VPERAZZINI;PWD=BIC;SERVER=sun3000.scmgroup.com"
    'Lconnect = "ODBC;DSN=Sun3000;UID=VPERAZZINI;PWD=BIC;SERVER=Sun3000"
    Lconnect = LeggiOdbcConnect
    'Point to the current workspace
    Set ws = DBEngine.Workspaces(0)
    
    'Connect to Oracle
    Set Db = ws.OpenDatabase("", False, True, Lconnect)
    ' Setto il tempo di QueryTimeOut a 120 min
    Db.QueryTimeout = 240
' GoTo Start
' *** Inizio caricamento Spedito.sql
    'Visualizza lo Status Meter
    Call acbInitMeter("1-CONSUMO ANNO da ORACLE", True)
    'Reset lo Status Meter
    intI = 0
    ' Cancella dati
    conn.Execute "Delete * From tblImportSpeditoNovorex"
    
    
    MyQuery = "SELECT Spedito.cod_art, " & "Anagrafica.DS_TEC as DESCR_ART, " & _
        "SUM (Spedito.qta_umv) qta_out, " & "TO_CHAR (Costo.csc_grp) as CS_CSC " & _
        "FROM grp.ricsped Spedito, db.an_articolo_grp Anagrafica, STAT_MMP_DATI_VIEW costo " _
        & "WHERE Spedito.Societa = '" & Me.txtFiliale & "' " & _
        "AND Spedito.COD_ART = Anagrafica.CD_ART(+) " & _
        "AND Spedito.COD_ART = costo.articolo(+) " & _
        "AND Spedito.Societa = costo.SOCIETA(+) " & "AND periodo(+) = " & AnnoC & Format(MeseC, "00") & _
        "AND Spedito.Data_Bolla BETWEEN '" & intStartDate & "' AND '" & intEndDate _
        & "' " & "AND Spedito.cod_art not like '000142996%' " & _
        "AND Spedito.qta_umv > 0 " & _
        "GROUP BY Spedito.cod_art, Anagrafica.DS_TEC, Costo.csc_grp "
    
    
'    MyQuery = "SELECT Spedito.cod_art, " & "Anagrafica.DS_TEC as DESCR_ART, " & _
'        "SUM (Spedito.qta_umv) qta_out, " & "TO_CHAR (Costo.csc_grp) as CS_CSC " & _
'        "FROM grp.ricsped Spedito, db.an_articolo_grp Anagrafica, STAT_MMP_DATI_VIEW costo " _
'        & "WHERE TRIM(Spedito.Societa) = '" & Me.txtFiliale & "' " & _
'        "AND TRIM(Spedito.COD_ART) = TRIM(Anagrafica.CD_ART(+)) " & _
'        "AND TRIM(Spedito.COD_ART) = TRIM(costo.articolo(+)) " & _
'        "AND TRIM(Spedito.Societa) = TRIM(costo.SOCIETA(+)) " & "AND periodo(+) = " & AnnoC & Format(MeseC, "00") & _
'        "AND Spedito.Data_Bolla BETWEEN '" & intStartDate & "' AND '" & intEndDate _
'        & "' " & "AND Spedito.cod_art not like '000142996%' " & _
'        "AND Spedito.qta_umv > 0 " & _
'        "GROUP BY Spedito.cod_art, Anagrafica.DS_TEC, Costo.csc_grp "

'AND Spedito.Data_Bolla BETWEEN TO_DATE ('01-Gen-2011',
'                                           'DD-MON-YYYY HH24:MI:SS',
'                                           'NLS_DATE_LANGUAGE = Italian'
'                                  )
'                          \\\\\\\    AND  TO_DATE ('31-Dic-2011',
'                                            'DD-MON-YYYY HH24:MI:SS',
'                                            'NLS_DATE_LANGUAGE = Italian'
'                                   )

    Set rst = Db.OpenRecordset(MyQuery, dbOpenSnapshot, dbSQLPassThrough)
    Do While Not rst.EOF
       Set qm = db0.QueryDefs("qrySpeditoNovorexIsrt")
       qm!iCOD_ART = rst![Cod_art]
       qm!iDESCRIZIONE = rst![DESCR_ART]
       qm!iQta_Out = rst![qta_out]
       qm!iCS_CSC = rst![Cs_Csc]
       qm!iUpdateDate = Format(Date, "mm/dd/yyyy")
       qm.Execute
       rst.MoveNext
        ' Aggiorna lo Status Meter
        intI = intI + (1 / 300)
        Call acbUpdateMeter(Int(intI))
    ' Attende un secondo
    DoEvents
    Loop
    'Close lo Status Meter
    Call acbCloseMeter
    rst.Close
    



' ********************************************************************************************************
' *** Inizio caricamento in tblGiacenzaNovorex i codici che non esistono in tblSpedizionii ***************
' ********************************************************************************************************

'Visualizza lo Status Meter
    Call acbInitMeter("5-ISRT ANAGRAFICHE ARTICOLO SPEDIZIONI", True)
    'Reset lo Status Meter
    intI = 0

Set bqry = db0.QueryDefs("qryArticoliImportSpeditoNovorex")
Set brs = bqry.OpenRecordset
  Do While Not brs.EOF
    Set qr1 = db0.QueryDefs("qryImportSpeditoNovorexIsrt")
    qr1!iCD_ART = brs![Cod_art]
    qr1!iDescr_Art = brs![Descrizione]
    qr1!iUM = "nu"
    qr1!iQta_Out = brs![qta_out]
    qr1!iCS_CSC = brs![Cs_Csc]
    qr1.Execute
    brs.MoveNext
' Aggiorna lo Status Meter
        intI = intI + (1 / 300)
        Call acbUpdateMeter(Int(intI))
    ' Attende un secondo
    DoEvents
  Loop
'Close lo Status Meter
    Call acbCloseMeter
  brs.Close

' start:

'***************************************
' *** Memorizzo i consumi in tblArticoli
'***************************************
Set db0 = CurrentDb
Set conn = CurrentProject.Connection
'Visualizza lo Status Meter
    Call acbInitMeter("9-AGGIORNO CONSUMI", True)
    'Reset lo Status Meter
    intI = 0
    sngPercento = 0
'memorizzo il periodo di partenza ed il numero di mesi per calcolo media consumi
Set bqry = db0.QueryDefs("qryConsumoNovorex")
    Set brs = bqry.OpenRecordset
    ' Numero Transazioni
        intMassimo = rst.RecordCount
    'Aggiorno i dati in tblArticoli
    Do While Not brs.EOF
    '
    ' Debug.Print brs.Fields("Cod_art"), brs.Fields("SConsumo"), brs.Fields("SSpedito"), brs.Fields("Num_Eventi")
    'Memorizzo i dati nella tblarticoli
        
        Set qr1 = db0.QueryDefs("qryArticoliNovorexUpdate")
        qr1!iCOD_ART = brs![Cod_art]
        qr1!iQta_Out = brs![qta_out]
        qr1.Execute
        brs.MoveNext
        ' Aggiorna lo Status Meter
            sngPercento = intI / (intMassimo / 100)
            If sngPercento >= 1 Then
                Call acbUpdateMeter(Int(sngPercento))
            End If
    Loop
    'Close lo Status Meter
    Call acbCloseMeter
    brs.Close
 Else
    Exit Sub

End If
'start:

' ********************************************************************************************************
' *** Inizio Esportazione Giacenze e Consumi Filiale nel file CSV ****************************************
' ********************************************************************************************************


Dim objField As ADODB.Field
Dim intFile As Integer
Dim strSQL As String, strDataLine As String
Dim filenm As String
Dim i As Integer


' Costruzione File da aprire
intFile = FreeFile
i = 1

filenm = CurrentProject.Path & "\Export\" & Format(Date, "yyyymmdd") & _
    Me.txtFiliale.Column(1) & "_" & i & ".tsv"

' Cerca File da aprire
    If FileExists(TrailingSlash(CurrentProject.Path) & "\Export\" & Format(Date, _
        "yyyymmdd") & Me.txtFiliale.Column(1) & "_" & i & ".tsv") = False Then
    Else
      Do While FileExists(TrailingSlash(CurrentProject.Path) & "\Export\" & _
          Format(Date, "yyyymmdd") & Me.txtFiliale.Column(1) & "_" & i & ".tsv") = True
       i = i + 1
      ' MsgBox "Il ciclo è stato eseguito " & i & " volte."
       Loop
    filenm = CurrentProject.Path & "\Export\" & Format(Date, "yyyymmdd") & _
        Me.txtFiliale.Column(1) & "_" & i & ".tsv"
    End If
' Chiede se si vuole esportare il file
If vbYes = MsgBox("Vuoi esportare i dati in  " & filenm, vbQuestion + vbYesNo + _
    vbDefaultButton2, gstrAppTitle) Then
    ' Visualizza puntatore mouse a clessidra
    ' Screen.MousePointer = vbHourGlass

    Open filenm For Output As #intFile
    ' Inserisce testata
    strDataLine = "COD_ART" & Chr(9) & "DESCRIZIONE" & Chr(9) & "UM" & Chr(9) & _
        "CS_CSC" & Chr(9) & "QT_GIAC" & Chr(9) & "QT_OUT" & Chr(9) & _
        "Periodo: " & Chr(9) & Me.txtMovimentoFrom & Chr(9) & Me.txtMovimentoTo

    Print #intFile, strDataLine
    'Ora loop per il recordset e scrive un TSV file per ogni record
    Set Db = CurrentDb
       Set brs = DBEngine(0)(0).OpenRecordset("SELECT * FROM tblGiacenzaNovorex")
   
    If Not brs.EOF And Not brs.BOF Then
    brs.MoveFirst
    End If
    While Not brs.EOF
    strDataLine = brs.Fields("Cd_art").Value & Chr(9) & _
        brs.Fields("Descr_art").Value & Chr(9) & brs.Fields("Um").Value & Chr(9) & _
        brs.Fields("Cs_csc").Value & Chr(9) & brs.Fields("Qt_giac").Value & Chr(9) _
        & brs.Fields("qta_out").Value
   
    Print #intFile, strDataLine
    brs.MoveNext
    strDataLine = ""
    Wend
    MsgBox ("I Dati sono stati salvati come TSV file" & CurrentProject.Path & _
        "\Export\" & Format(Date, "yyyymmdd") & _
    Me.txtFiliale.Column(1) & "_" & i & ".tsv")
    brs.Close
    Set brs = Nothing
    Set Db = Nothing
    Close #intFile
Else
Exit Sub
' Visualizza puntatore mouse std
' Screen.MousePointer = vbDefault

End If



Exit_CmdImportaGiacenzeNovorex_Click:
    Exit Sub

Err_CmdImportaGiacenzeNovorex_Click:
    MsgBox Err.Description
    Resume Exit_CmdImportaGiacenzeNovorex_Click

End Sub

Private Sub txtMovimentoFrom_DblClick(Cancel As Integer)
    ' Call the companion button click
    cmdOrderFromCal_Click
End Sub

Private Sub txtMovimentoTo_DblClick(Cancel As Integer)
    ' Call the companion button click
    cmdOrderToCal_Click
End Sub
