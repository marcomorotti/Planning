Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    PictureTiling = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =17010
    DatasheetFontHeight =10
    ItemSuffix =57
    Left =1044
    Top =2544
    Right =18312
    Bottom =8460
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xe8ecb2240ed9e340
    End
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    FilterOnLoad =0
    SaveSplitterBarPosition =0
    UseDefaultPaperSize =255
    SaveSplitterBarPosition =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =0
    DatasheetGridlinesColor12 =12632256
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            SizeMode =3
            PictureAlignment =2
            Width =1701
            Height =1701
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Subform
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin FormHeader
            Height =519
            BackColor =-2147483633
            Name ="IntestazioneMaschera"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =83
                    Left =9693
                    Top =15
                    Width =1644
                    FontSize =9
                    FontWeight =700
                    ForeColor =255
                    Name ="cmdSave"
                    Caption ="&Save e Print"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ShortcutMenuBar ="Form Control Shortcut Bar"
                    ControlTipText ="Salvale modifiche e crea file xls"
                    UnicodeAccessKey =83
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000d0687050c06860ffb05850ffa05050ffa05050ff ,
                        0xa05050ff904850ff904840ff904840ff804040ff803840ff803840ff703840ff ,
                        0x703830ff0000000000000000d06870fff09090ffe08080ffb04820ff403020ff ,
                        0xc0b8b0ffc0b8b0ffd0c0c0ffd0c8c0ff505050ffa04030ffa04030ffa03830ff ,
                        0x703840ff0000000000000000d07070ffff98a0fff08880ffe08080ff705850ff ,
                        0x404030ff907870fff0e0e0fff0e8e0ff908070ffa04030ffa04040ffa04030ff ,
                        0x803840ff0000000000000000d07870ffffa0a0fff09090fff08880ff705850ff ,
                        0x000000ff404030fff0d8d0fff0e0d0ff807860ffb04840ffb04840ffa04040ff ,
                        0x804040ff0000000000000000d07880ffffa8b0ffffa0a0fff09090ff705850ff ,
                        0x705850ff705850ff705850ff706050ff806860ffc05850ffb05050ffb04840ff ,
                        0x804040ff0000000000000000e08080ffffb0b0ffffb0b0ffffa0a0fff09090ff ,
                        0xf08880ffe08080ffe07880ffd07070ffd06870ffc06060ffc05850ffb05050ff ,
                        0x904840ff0000000000000000e08890ffffb8c0ffffb8b0ffd06060ffc06050ff ,
                        0xc05850ffc05040ffb05030ffb04830ffa04020ffa03810ffc06060ffc05850ff ,
                        0x904840ff0000000000000000e09090ffffc0c0ffd06860ffffffffffffffffff ,
                        0xfff8f0fff0f0f0fff0e8e0fff0d8d0ffe0d0c0ffe0c8c0ffa03810ffc06060ff ,
                        0x904850ff0000000000000000e098a0ffffc0c0ffd07070ffffffffffffffffff ,
                        0xfffffffffff8f0fff0f0f0fff0e8e0fff0d8d0ffe0d0c0ffa04020ffd06860ff ,
                        0xa05050ff0000000000000000f0a0a0ffffc0c0ffe07870ffffffffffffffffff ,
                        0xfffffffffffffffffff8f0fff0f0f0fff0e8e0fff0d8d0ffb04830ffd07070ff ,
                        0xa05050ff0000000000000000f0a8a0ffffc0c0ffe08080ffffffffffffffffff ,
                        0xfffffffffffffffffffffffffff8f0fff0f0f0fff0e8e0ffb05030ffe07880ff ,
                        0xa05050ff0000000000000000f0b0b0ffffc0c0fff08890ffffffffffffffffff ,
                        0xfffffffffffffffffffffffffffffffffff8f0fff0f0f0ffc05040ff603030ff ,
                        0xb05850ff0000000000000000f0b0b0ffffc0c0ffff9090ffffffffffffffffff ,
                        0xfffffffffffffffffffffffffffffffffffffffffff8f0ffc05850ffb05860ff ,
                        0xb05860ff0000000000000000f0b8b0fff0b8b0fff0b0b0fff0b0b0fff0a8b0ff ,
                        0xf0a0a0ffe098a0ffe09090ffe09090ffe08890ffe08080ffd07880ffd07870ff ,
                        0xd07070ff00000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =9693
                    LayoutCachedTop =15
                    LayoutCachedWidth =11337
                    LayoutCachedHeight =375
                    PictureCaptionArrangement =5
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =12981
                    Top =15
                    Width =1644
                    TabIndex =1
                    ForeColor =0
                    Name ="cmdClose"
                    Caption ="Esci No Save"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad
                    End
                    FontName ="MS Sans Serif"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    Tag ="ShiftLeftNewUnit,ShiftLeftPermLocn"
                    ControlTipText ="Esce senza salvare"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =12981
                    LayoutCachedTop =15
                    LayoutCachedWidth =14625
                    LayoutCachedHeight =375
                    PictureCaptionArrangement =5
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =11337
                    Top =15
                    Width =1644
                    FontWeight =700
                    TabIndex =2
                    ForeColor =255
                    Name ="cmdCalcola"
                    Caption ="Calcolo"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    Tag ="ShiftLeftNewUnit,ShiftLeftPermLocn"
                    ControlTipText ="Calcola"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000a08070ff604830ff ,
                        0x604830ff604830ff604830ff604830ff604830ff604830ff604830ff604830ff ,
                        0x604830ff000000000000000000000000a08070ff604830ffa08070ffffffffff ,
                        0xb0a090ffb0a090ffb0a090ffb0a090ffb0a090ffb0a090ffb0a090ffb0a090ff ,
                        0x604830ff00000000a08070ff604830ffa08070ffffffffffa08070ffffffffff ,
                        0xfffffffffff8fffff0f0f0fff0e8e0fff0e0d0ffe0d0d0ffe0c8c0ffb0a090ff ,
                        0x604830ff00000000a08070ffffffffffa08070ffffffffffa08070ffffffffff ,
                        0xffffffffd0f0e0ff106850fff0f0f0fff0e0e0fff0d8d0ffe0d0c0ffb0a090ff ,
                        0x604830ff00000000a08070ffffffffffa08070ffffffffffa08070ffffffffff ,
                        0xffffffff209870ff209870ff209870ff209870ffc0c8c0ffe0d8d0ffb0a090ff ,
                        0x604830ff00000000a08070ffffffffffa08070ffffffffffa08870ffffffffff ,
                        0xffffffffe0f0f0ff209870fffff8f0ffc0e0d0ff209870fff0d8d0ffb0a090ff ,
                        0x604830ff00000000a08070ffffffffffa08870ffffffffffa08880ffffffffff ,
                        0xfffffffffffffffffffffffffffffffffff8f0ff209870fff0e0e0ffb0a090ff ,
                        0x604830ff00000000a08870ffffffffffa08880ffffffffffb09080ffffffffff ,
                        0xffffffff209870fffffffffffffffffffff8fffff0f0f0fff0e8e0ffb0a090ff ,
                        0x604830ff00000000a08880ffffffffffb09080ffffffffffb09080ffffffffff ,
                        0xffffffff209870ffb0d8c0ffffffffff107850ffd0e0e0fff0f0f0ffb0a090ff ,
                        0x604830ff00000000b09080ffffffffffb09080ffffffffffb09880ffffffffff ,
                        0xffffffffd0e8e0ff209870ff209870ff209870ff107850ffd0b8b0ffb0a090ff ,
                        0x604830ff00000000b09080ffffffffffb09880ffffffffffb09880ffffffffff ,
                        0xffffffffffffffffffffffffffffffff209870ffd0d8d0ffa09080ff605040ff ,
                        0x604830ff00000000b09880ffffffffffb09880ffffffffffb0a090ffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffd0b8b0ffd0c8c0ff604830ff ,
                        0xd0b0a09000000000b09880ffffffffffb0a090ffffffffffc0a090ffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffc0a8a0ff604830ffd0b0a090 ,
                        0x0000000000000000b0a090ffffffffffc0a090ffffffffffc0a090ffd0c0b0ff ,
                        0xd0c0b0ffd0c0b0ffd0b8b0ffd0b8a0ffc0b0a0ffc0a090ffd0b0a09000000000 ,
                        0x0000000000000000c0a090ffffffffffc0a090ffe0c8b0ffe0c8c0ffe0d0c0ff ,
                        0xe0d0c0ffe0d0c0ffe0d0c0ffd0b8b0ffd0b0a090000000000000000000000000 ,
                        0x0000000000000000b09890ffd0c0b0ffd0c0b0ffd0c0b0ffd0c0b0ffd0c0b0ff ,
                        0xd0b8b0ffc0b0a0ffd0b0a0900000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =11337
                    LayoutCachedTop =15
                    LayoutCachedWidth =12981
                    LayoutCachedHeight =375
                    PictureCaptionArrangement =5
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =6405
                    Top =15
                    Width =1644
                    FontSize =9
                    FontWeight =700
                    TabIndex =3
                    ForeColor =1845071
                    Name ="cmdApriDir"
                    Caption ="Apri Dir File"
                    OnClick ="[Event Procedure]"
                    FontName ="Gill Sans MT"
                    ControlTipText ="Apre direttorio file xls"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000708890ff608090ff607880ff507080ff506070ff405860ff ,
                        0x404850ff303840ff203030ff202030ff101820ff101010ff101020ff00000000 ,
                        0x0000000000000000708890ff90a0b0ff70b0d0ff0090d0ff0090d0ff0090d0ff ,
                        0x0090c0ff1088c0ff1080b0ff1080b0ff2078a0ff207090ff204860ff20303050 ,
                        0x0000000000000000808890ff80c0d0ff90a8b0ff80e0ffff60d0ffff50c8ffff ,
                        0x50c8ffff40c0f0ff30b0f0ff30a8f0ff20a0e0ff1090d0ff206880ff202830b0 ,
                        0x00000000000000008090a0ff80d0f0ff90a8b0ff90c0d0ff70d8ffff60d0ffff ,
                        0x60d0ffff50c8ffff50c0ffff40b8f0ff30b0f0ff30a8f0ff1088d0ff204860ff ,
                        0x10283020000000008090a0ff80d8f0ff80c8e0ff90a8b0ff80e0ffff70d0ffff ,
                        0x60d8ffff60d0ffff60d0ffff50c8ffff40c0f0ff40b8f0ff30b0f0ff206880ff ,
                        0x10486090000000008098a0ff90e0f0ff90e0ffff90a8b0ff90b8c0ff70d8ffff ,
                        0x60d8ffff60d8ffff60d8ffff60d0ffff50d0ffff50c8ffff40b8f0ff30a0e0ff ,
                        0x406070f0506070308098a0ff90e0f0ffa0e8ffff80c8e0ff90a8b0ff80e0ffff ,
                        0x80e0ffff80e0ffff80e0ffff80e0ffff80e0ffff80e0ffff70d8ffff70d8ffff ,
                        0x50a8d0ff506070a090a0a0ffa0e8f0ffa0e8ffffa0e8ffff90b0c0ff90b0c0ff ,
                        0x90a8b0ff90a8b0ff80a0b0ff80a0b0ff8098a0ff8098a0ff8090a0ff8090a0ff ,
                        0x808890ff708890ff90a0b0ffa0e8f0ffa0f0ffffa0e8ffffa0e8ffff80d8ffff ,
                        0x60d8ffff60d8ffff60d8ffff60d8ffff60d8ffff60d8ffff708890ff00000000 ,
                        0x000000000000000090a0b0ffa0f0f0ffb0f0f0ffa0f0ffffa0e8ffffa0e8ffff ,
                        0x70d8ffff90a0a0ff8098a0ff8098a0ff8090a0ff809090ff708890ff00000000 ,
                        0x000000000000000090a8b0ffa0d0e0ffb0f0f0ffb0f0f0ffa0f0ffffa0e8ffff ,
                        0x90a0b0ff80a8b0800000000000000000000000000000000000000000906850ff ,
                        0x906850ff906850ff90a8b05090a8b0ff90a8b0ff90a8b0ff90a8b0ff90a8b0ff ,
                        0x90a8b090000000000000000000000000000000000000000000000000a0787050 ,
                        0x906850ff906850ff000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000907860ff9068506000000000a0787010a09080ff ,
                        0xa0887050907860ff000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000a0988040a09080ffa08880ffb09880ffa0908080 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =6405
                    LayoutCachedTop =15
                    LayoutCachedWidth =8049
                    LayoutCachedHeight =375
                    PictureCaptionArrangement =5
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =80
                    Left =8049
                    Top =15
                    Width =1644
                    FontSize =9
                    FontWeight =700
                    TabIndex =4
                    ForeColor =255
                    Name ="CmdPrint"
                    Caption ="&Print"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ShortcutMenuBar ="Form Control Shortcut Bar"
                    ControlTipText ="Crea file xls"
                    UnicodeAccessKey =80
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000a08870ff ,
                        0x907860ff807060ff807060ff807060ff807060ff000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000000000000a09080ff ,
                        0xfffffffffffffffffff8fffffff8ffff807060ff000000000000000000000000 ,
                        0x0000000000000000a098a090908890ff706060ff504850ff505050ffa09080ff ,
                        0xfffffffff0d8b0fff0d8b0fff0d8b0ff807060ff505050ff504850ff706060ff ,
                        0x706860ff707070b0909090ff909890ffa0a0a0ff403840ff403840ffa09080ff ,
                        0xffffffffffe8d0ffe07850fff0d8b0ff807060ff403840ff403840ff909090ff ,
                        0x909090ff706860ff909090ffa0a0a0ff909890ff403840ff403840ff908870ff ,
                        0xe0e8e0fff0e0b0fff0d8b0fff0d8b0ff807060ff403840ff403840ffa0a0a0ff ,
                        0xa0a0a0ff706860ff908890ff908890ff908890ff707070ff707070ff707070ff ,
                        0x707070ff707070ff707070ff707070ff707070ff707070ff707070ff908890ff ,
                        0x908080ff706860ff908890ffc0b8c0ffd0c8d0ff808880ffb0a8b0ffb0a8b0ff ,
                        0xb0a8b0ffb0a8b0ffb0b0b0ffb0b0b0ffb0b0b0ffb0b0b0ff807880ffc0c8c0ff ,
                        0xb0b0b0ff706860ff909090ffd0d0d0ffd0c8d0ff808880ffb0a8b0ffb0a8b0ff ,
                        0xb0a8b0ffb0a8b0ffffa860ffffa860ffffa860ffb0b0b0ff807880ffc0c8c0ff ,
                        0xc0c0c0ff706860ff909090fff0f8f0fff0f0f0ffa0a0a0ffd0d0d0ffd0d0d0ff ,
                        0xd0d0d0ffd0d0d0ffd0d0d0ffd0d0d0ffd0d0d0ffd0d0d0ff909890fff0f0f0ff ,
                        0xf0e8f0ff706860ffa098a0ffffffffffffffffff909090ffe0d8e0ffe0d8e0ff ,
                        0xe0d8e0ffe0d8e0ffe0d8e0ffc0d0d0ff80a090ff406850ff205030ffa0b0a0ff ,
                        0xe0e8e0ff706860ffb0b0b070b0b0b0ffb0b0b0ff909090ff909090ff909090ff ,
                        0x909090ff909090ff908890ff507060ff307840ff60b080ff50b070ff307840ff ,
                        0x507060ff80888080000000000000000000000000505050a0706870ffb09080ff ,
                        0xfffffffffffffffffff8ffff407850ffa0d0b0fff0ffffffc0e0d0ff40b070ff ,
                        0x004010c00000000000000000000000000000000050505080505850ffb09080ff ,
                        0xfffffffffffffffffff8ffff508050ffffffffff50b870fffff8ffff90c890ff ,
                        0x004020c0000000000000000000000000000000000000000000000000b09080ff ,
                        0xffffffffffffffffffffffffa0b0a0ff308040ff40b070ff40a850ffffffffff ,
                        0x509860b0000000000000000000000000000000000000000000000000b09080ff ,
                        0xfffffffffffffffffffffffff0f0f0ff506040ff004010c0004010c060a060b0 ,
                        0xa0d8a090000000000000000000000000000000000000000000000000b09080ff ,
                        0xb09080ffb09080ffb09080ffb09080ffb09080ff000000000000000000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =8049
                    LayoutCachedTop =15
                    LayoutCachedWidth =9693
                    LayoutCachedHeight =375
                    PictureCaptionArrangement =5
                End
                Begin Label
                    OverlapFlags =87
                    TextFontFamily =0
                    Width =6405
                    Height =375
                    FontSize =15
                    FontWeight =700
                    BorderColor =16251385
                    ForeColor =1769599
                    Name ="Auto_Title0"
                    Caption ="LIVELLO DELLE SCORTE - OTTIMIZZAZIONE"
                    FontName ="Trebuchet"
                    LayoutCachedWidth =6405
                    LayoutCachedHeight =375
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =14668
                    Width =381
                    Height =366
                    FontSize =9
                    FontWeight =700
                    TabIndex =5
                    ForeColor =10040115
                    Name ="cmdHelp"
                    Caption ="Help"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Composizione automatica"
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000e0e8e000e0c8b000 ,
                        0xe0d8d000e0d0c010e0d0c010d0d0c010d0d0c000d0d0d000e0e0e00000000000 ,
                        0x0000000000000000000000000000000000000000f0e8e0009068303080582080 ,
                        0x905010c0804820e0804820c0804810b06040108050381030d0c8c01000000000 ,
                        0x000000000000000000000000e0780000e0a05010a0683070c08860f0e0c8b0ff ,
                        0xf0f0f0fffffffffffffffffff0f0f0ffe0c8c0ffa07850c040301060d0c8c010 ,
                        0xe0d8d0000000000000000000e0882000b0703070e0a880fffff0e0ffe0b8a0ff ,
                        0xd08050ffc05820ffc05820ffd08050ffe0b8a0fff0e8e0ffb09070f050301060 ,
                        0xd0c8c000e0e0e00000000000b0783030d09870f0fff0e0ffe0a890ffc05010ff ,
                        0xc05010ffe0a890ffffffffffb04810ffb04810ffd0a080fff0f0e0ffa07050d0 ,
                        0x50381030d0d0d000f0f0f000b0784080f0d8c0fff0c8b0ffe05820ffd05810ff ,
                        0xd05010ffe08050ffe0a880ffc05010ffb04810ffb04810ffe0b8a0ffe0c8c0ff ,
                        0x50401080d0d0d010f0f0f000d08040e0fff8f0fff09870fff06020ffe05820ff ,
                        0xe05820fff0a890ffffffffffd05010ffc05010ffb05010ffc07850fff0f0f0ff ,
                        0x804020c0e0d0c000f0f0f000d08040f0ffffffffff7840ffff6830fff06820ff ,
                        0xf06020fff08850fffffffffff0c0b0ffc05820ffb05010ffb05820ffffffffff ,
                        0x804820e0e0d0c010f0f0f000d08850f0ffffffffff8050ffff7030ffff6830ff ,
                        0xff6830ffff6820fff09060fffff8f0fff0d8c0ffc05020ffc05820ffffffffff ,
                        0x804820e0e0d8d010f0f0f000d08050c0fff8f0ffffa880ffff7040ffff8850ff ,
                        0xffb090ffff7030fff06820fff09070fffffffffff08050ffd08860fffff0f0ff ,
                        0x805820b0e0d8d010f0f0f000c0804070f0d8c0ffffd0c0ffff7840ffff9870ff ,
                        0xffffffffffc8b0ffff9060ffffc8b0fffff8f0fff07840fff0c8b0ffe0c8b0ff ,
                        0x90602070e0c8b00000000000c0884030e0a070f0fff8f0ffffc0a0ffff7840ff ,
                        0xffb8a0fffff8f0fffffffffffff0e0ffff9870fff0b8a0fffff0e0ffc08850e0 ,
                        0xa0682030f0e8e0000000000000000000c0884060e0b8a0f0fff8f0ffffd0c0ff ,
                        0xffa880ffff8850ffff8850ffffa880fff0d0c0fffff0e0ffd0a880f0a0683060 ,
                        0xe0c0a00000000000000000000000000000000000c0884060e0a070f0f0d8c0ff ,
                        0xfff8f0fffffffffffffffffffff8f0fff0d8c0ffc09060e0a0703050f0b89000 ,
                        0x0000000000000000000000000000000000000000f0f0f000c0884030c0804070 ,
                        0xe0a070c0d09870e0d09860f0d09870d0b0784070b0784020f0e8f00000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0xf0f0f000f0f0f000f0f0f000f0f0f000f0f0f00000000000f0f0f00000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =14668
                    LayoutCachedWidth =15049
                    LayoutCachedHeight =366
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =5410
            BackColor =-2147483633
            Name ="detail"
            Begin
                Begin ToggleButton
                    OverlapFlags =85
                    Left =120
                    Top =3315
                    Width =240
                    Height =300
                    Name ="Toggle1"
                    AfterUpdate ="[Event Procedure]"
                    Caption ="+"

                    LayoutCachedLeft =120
                    LayoutCachedTop =3315
                    LayoutCachedWidth =360
                    LayoutCachedHeight =3615
                End
                Begin ToggleButton
                    OverlapFlags =85
                    Left =2102
                    Top =3307
                    Width =240
                    Height =300
                    TabIndex =1
                    Name ="Toggle2"
                    AfterUpdate ="[Event Procedure]"
                    Caption ="+"

                    LayoutCachedLeft =2102
                    LayoutCachedTop =3307
                    LayoutCachedWidth =2342
                    LayoutCachedHeight =3607
                End
                Begin ToggleButton
                    OverlapFlags =85
                    Left =118
                    Top =3755
                    Width =240
                    Height =300
                    TabIndex =2
                    Name ="Toggle3"
                    AfterUpdate ="[Event Procedure]"
                    Caption ="+"

                    LayoutCachedLeft =118
                    LayoutCachedTop =3755
                    LayoutCachedWidth =358
                    LayoutCachedHeight =4055
                End
                Begin Subform
                    OverlapFlags =85
                    Left =90
                    Top =90
                    Width =7980
                    Height =3105
                    TabIndex =3
                    Name ="frmCategoriaEventiCva"
                    SourceObject ="Form.frmCategoriaEventiCva"

                    LayoutCachedLeft =90
                    LayoutCachedTop =90
                    LayoutCachedWidth =8070
                    LayoutCachedHeight =3195
                End
                Begin Subform
                    OverlapFlags =85
                    Left =405
                    Top =3285
                    Width =1500
                    Height =300
                    TabIndex =4
                    Name ="frmCategoriaEventiCvaQta"
                    SourceObject ="Form.frmCategoriaEventiCvaQta"

                    LayoutCachedLeft =405
                    LayoutCachedTop =3285
                    LayoutCachedWidth =1905
                    LayoutCachedHeight =3585
                End
                Begin Subform
                    OverlapFlags =85
                    Left =2477
                    Top =3285
                    Width =1455
                    Height =300
                    TabIndex =5
                    Name ="frmCategoriaEventiCvaQtaCalc"
                    SourceObject ="Form.frmCategoriaEventiCvaQtaCalc"

                    LayoutCachedLeft =2477
                    LayoutCachedTop =3285
                    LayoutCachedWidth =3932
                    LayoutCachedHeight =3585
                End
                Begin Subform
                    OverlapFlags =85
                    Left =448
                    Top =3755
                    Width =1410
                    Height =315
                    TabIndex =6
                    Name ="frmCategoriaEventiCvaVal"
                    SourceObject ="Form.frmCategoriaEventiCvaVal"

                    LayoutCachedLeft =448
                    LayoutCachedTop =3755
                    LayoutCachedWidth =1858
                    LayoutCachedHeight =4070
                End
                Begin Subform
                    OverlapFlags =85
                    Left =2480
                    Top =3732
                    Height =345
                    TabIndex =7
                    Name ="frmCategoriaEventiCvaValCalc"
                    SourceObject ="Form.frmCategoriaEventiCvaValCalc"

                    LayoutCachedLeft =2480
                    LayoutCachedTop =3732
                    LayoutCachedWidth =3920
                    LayoutCachedHeight =4077
                End
                Begin ToggleButton
                    OverlapFlags =85
                    Left =2102
                    Top =3755
                    Width =240
                    Height =300
                    TabIndex =8
                    Name ="Toggle4"
                    AfterUpdate ="[Event Procedure]"
                    Caption ="+"
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =2102
                    LayoutCachedTop =3755
                    LayoutCachedWidth =2342
                    LayoutCachedHeight =4055
                End
                Begin Subform
                    OverlapFlags =85
                    Left =8196
                    Top =23
                    Width =5295
                    Height =3210
                    TabIndex =9
                    Name ="Product Registration"
                    SourceObject ="Form.frmCategoriaEventiHelp"
                    EventProcPrefix ="Product_Registration"

                    LayoutCachedLeft =8196
                    LayoutCachedTop =23
                    LayoutCachedWidth =13491
                    LayoutCachedHeight =3233
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =-2147483633
            Name ="PièDiPaginaMaschera"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
' Option Explicit
Dim LoadDataFrmCategoriaEventiCvaQtaOk As Boolean
Dim LoadDataFrmCategoriaEventiCvaQtaCalcOk As Boolean
Dim LoadDataFrmCategoriaEventiCvaValOk As Boolean
Dim LoadDataFrmCategoriaEventiCvaValCalcOk As Boolean
Dim startX As Integer
Dim startY As Integer


Private Sub cmdApriDir_Click()
        Call fHandleFile(CurrentProject.Path & "\Export", WIN_NORMAL)
End Sub

Private Sub cmdHelp_Click()
Dim FormHelpId As Long
Dim curForm As Form
    

    'Set the curForm variable to the currently active form.
    Set curForm = Screen.ActiveForm
    FormHelpId = 910
    'Call the function to start the Help file, passing it the name of the
    'Help file and context-id.
    Show_Help FormHelpFile, FormHelpId

End Sub

Private Sub Form_Open(Cancel As Integer)
DoCmd.SetWarnings False
DoCmd.RunSQL "DELETE * from tblCategoriaEventiCvaSimu"
CurrentProject.Connection.Execute "INSERT INTO tblCategoriaEventiCvaSimu SELECT * FROM tblCategoriaEventiCva"
   Forms![frmCategoriaEventiCvaMonitor]![frmCategoriaEventiCva].Form.Requery
    'DoCmd.CopyObject , "tblCategoriaEventiCvaSimu", acTable, "tblCategoriaEventiCva"
DoCmd.SetWarnings True

startX = 1500
startY = 300
LoadDataCategoriaEventiCvaQta = False
' 1ò quadtrante
Me.frmCategoriaEventiCvaQta.Width = startX
Me.frmCategoriaEventiCvaQta.Height = startY
' 2ò quadrante
Me.frmCategoriaEventiCvaQtaCalc.Width = startX
Me.frmCategoriaEventiCvaQtaCalc.Height = startY
' 3ò quadrante
Me.frmCategoriaEventiCvaVal.Width = startX
Me.frmCategoriaEventiCvaVal.Height = startY
' 4ò quadrante
Me.frmCategoriaEventiCvaValCalc.Width = startX
Me.frmCategoriaEventiCvaValCalc.Height = startY
' Crea la tabella Simulazione livelli Servizio
'Forms![frmCategoriaEventiCvaMonitor]![frmCategoriaEventiCva].Form.Requery
'DoCmd.Maximize

'Forms.Form3.Section(3).Visible
'Me.Visible = True
End Sub

Private Sub Toggle1_AfterUpdate()
If Toggle1.Value = -1 Then
'    sub1.Visible = True
 Call ResizeCtl(Me, frmCategoriaEventiCvaQta, startX, startY, 300)
       If LoadDataFrmCategoriaEventiCvaQtaOk = False Then
      Call LoadDataFrmCategoriaEventiCvaQta(Me, frmCategoriaEventiCvaQta)
   End If
Else
    Call ResizeCtl(Me, frmCategoriaEventiCvaQta, startX, startY, -300)
'    sub1.Visible = False
End If
End Sub

Private Sub Toggle2_AfterUpdate()
If Toggle2.Value = -1 Then
    Call ResizeCtl(Me, frmCategoriaEventiCvaQtaCalc, startX, startY, 300)
    If LoadDataFrmCategoriaEventiCvaQtaCalcOk = False Then
      Call LoadDataFrmCategoriaEventiCvaQtaCalc(Me, frmCategoriaEventiCvaQtaCalc)
   End If
Else
    Call ResizeCtl(Me, frmCategoriaEventiCvaQtaCalc, startX, startY, -300)
End If
End Sub

Private Sub Toggle3_AfterUpdate()
If Toggle3.Value = -1 Then
    Call ResizeCtl(Me, frmCategoriaEventiCvaVal, startX, startY, 300)
       If LoadDataFrmCategoriaEventiCvaValOk = False Then
      Call LoadDataFrmCategoriaEventiCvaVal(Me, frmCategoriaEventiCvaVal)
   End If
Else
    Call ResizeCtl(Me, frmCategoriaEventiCvaVal, startX, startY, -300)
End If
End Sub
Private Sub Toggle4_AfterUpdate()
If Toggle4.Value = -1 Then
    Call ResizeCtl(Me, frmCategoriaEventiCvaValCalc, startX, startY, 300)
       If LoadDataFrmCategoriaEventiCvaValCalcOk = False Then
      Call LoadDataFrmCategoriaEventiCvaValCalc(Me, frmCategoriaEventiCvaValCalc)
   End If
Else
    Call ResizeCtl(Me, frmCategoriaEventiCvaValCalc, startX, startY, -300)
End If

End Sub
'Da qui inizia la load dei dati di CvaQta
Private Function LoadDataFrmCategoriaEventiCvaQta(frm As Form, ctl As control)
Dim intI As Integer
Dim A1, A2, A3, A4, B1, B2, B3, C1, C2, D As Integer
Dim TotCol As Variant
Dim Db As Database

 On Error GoTo ErrLine
' *** calcola riga Qtà No-Picking
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "Np").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'A" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "Np").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'B" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "Np").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'C" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** D
ctl("txtDNp").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'D' AND Giac_Media <> 0"), "#,##0")
'     ***** Totale
ctl("txtNp").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento IS NULL AND Giac_Media <> 0"), "#,##0")

' **************************************************************************************************
' *** calcola riga Qtà Very-Slow
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "Vs").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'A" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "Vs").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'B" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "Vs").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'C" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** D
ctl("txtDVs").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'D' AND Giac_Media <> 0"), "#,##0")
'     ***** Totale
ctl("txtVs").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Very-Slow' AND Giac_Media <> 0"), "#,##0")

' **************************************************************************************************
' *** calcola riga Qtà Slow
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "S").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'A" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "S").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'B" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "S").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'C" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** D
ctl("txtDS").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'D' AND Giac_Media <> 0"), "#,##0")

'     ***** Totale
ctl("txtS").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Slow' AND Giac_Media <> 0"), "#,##0")

' **************************************************************************************************
' *** calcola riga Qtà Medium Slow
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "MS").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'A" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "MS").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'B" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "MS").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'C" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** D
ctl("txtDMs").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'D' AND Giac_Media <> 0"), "#,##0")
'     ***** Totale
ctl("txtMs").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium-Slow' AND Giac_Media <> 0"), "#,##0")
    
' **************************************************************************************************
' *** calcola riga Qtà Medium
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "M").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'A" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "M").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'B" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "M").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'C" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** D
ctl("txtDM").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'D' AND Giac_Media <> 0"), "#,##0")
'     ***** Totale
ctl("txtM").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium' AND Giac_Media <> 0"), "#,##0")

' **************************************************************************************************
' *** calcola riga Qtà Medium Fast
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "MF").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'A" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "MF").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'B" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "MF").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'C" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** D
ctl("txtDMf").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium-fast' AND AbcConsumoValoreLs = 'D' AND Giac_Media <> 0"), "#,##0")
'     ***** Totale
ctl("txtMF").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Medium-Fast' AND Giac_Media <> 0"), "#,##0")

' **************************************************************************************************
' *** calcola riga Qtà Fast
' **************************************************************************************************
'     ***** A1- A4

For intI = 1 To 4
ctl("txtA" & intI & "F").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'A" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "F").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'B" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "F").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'C" & intI & "' AND Giac_Media <> 0"), "#,##0")
Next intI
'     ***** D
ctl("txtDF").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'D' AND Giac_Media <> 0"), "#,##0")
'     ***** Totale
ctl("txtF").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Fast' AND Giac_Media <> 0"), "#,##0")

' **************************************************************************************************
' *** calcola riga Qtà Very Fast
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "VF").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'A" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "VF").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'B" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "VF").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'C" & intI & "' AND Giac_Media <> 0"), _
    "#,##0")
Next intI
'     ***** D
ctl("txtDVf").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'D' AND Giac_Media <> 0"), "#,##0")
'     ***** Totale
ctl("txtVF").Caption = Format(DCount("Cod_art", "tblArticoli", _
    "Classe_Evento = 'Very-Fast' AND Giac_Media <> 0"), "#,##0")
' **************************************************************************************************
' *** calcola totale colonna
' **************************************************************************************************

A1 = DCount("Cod_art", "tblArticoli", "AbcConsumoValoreLs = 'A1'AND Giac_Media <> 0")
A2 = DCount("Cod_art", "tblArticoli", "AbcConsumoValoreLs = 'A2'AND Giac_Media <> 0")
A3 = DCount("Cod_art", "tblArticoli", "AbcConsumoValoreLs = 'A3'AND Giac_Media <> 0")
A4 = DCount("Cod_art", "tblArticoli", "AbcConsumoValoreLs = 'A4'AND Giac_Media <> 0")
B1 = DCount("Cod_art", "tblArticoli", "AbcConsumoValoreLs = 'B1'AND Giac_Media <> 0")
B2 = DCount("Cod_art", "tblArticoli", "AbcConsumoValoreLs = 'B2'AND Giac_Media <> 0")
B3 = DCount("Cod_art", "tblArticoli", "AbcConsumoValoreLs = 'B3'AND Giac_Media <> 0")
C1 = DCount("Cod_art", "tblArticoli", "AbcConsumoValoreLs = 'C1'AND Giac_Media <> 0")
C2 = DCount("Cod_art", "tblArticoli", "AbcConsumoValoreLs = 'C2'AND Giac_Media <> 0")
D = DCount("Cod_art", "tblArticoli", "AbcConsumoValoreLs = 'D'AND Giac_Media <> 0")
TotCol = A1 + A2 + A3 + A4 + B1 + B2 + B3 + C1 + C2 + D
ctl("txtTot").Caption = Format(TotCol, "#,##0")
ctl("txtA1").Caption = Format(A1, "#,##0")
ctl("txtA2").Caption = Format(A2, "#,##0")
ctl("txtA3").Caption = Format(A3, "#,##0")
ctl("txtA4").Caption = Format(A4, "#,##0")
ctl("txtB1").Caption = Format(B1, "#,##0")
ctl("txtB2").Caption = Format(B2, "#,##0")
ctl("txtB3").Caption = Format(B3, "#,##0")
ctl("txtC1").Caption = Format(C1, "#,##0")
ctl("txtC2").Caption = Format(C2, "#,##0")
ctl("txtD").Caption = Format(D, "#,##0")
' Aggiorna tblDashBoard  con numero cod in giacenza
Set Db = CurrentDb
Db.Execute "UPDATE tblDashBoard SET Actual = " & TotCol & _
            " Where Indice = 'Giacenza'", dbFailOnError

  LoadDataFrmCategoriaEventiCvaQtaOk = True
Forms!frmCategoriaEventiCvaMonitor.SetFocus
   
ExitLine:
   Exit Function
ErrLine:
   LoadDataFrmCategoriaEventiCvaQtaOk = False
   Resume ExitLine
End Function
Public Function LoadDataFrmCategoriaEventiCvaQtaCalc(frm As Form, ctl As control)
Dim intI As Integer
Dim intJ As Integer
Dim intA As Integer
Dim intB As Integer
Dim IntC As Integer
Dim A1, A2, A3, A4, B1, B2, B3, C1, C2 As Double ' Totale Colonne
Dim TotCol, Actual, VPcntIndice As Variant
Dim A, b, c As Double 'Subtotali righe
Dim Np, Vs, s, Ms, M, Mf, f, Vf As Double  'Totale righe
Dim SS1 As Double
Dim SS(8, 9) As Double
Dim SSF(8, 9) As Double
Dim LS(8, 9) As Variant
Dim GiacM(8, 9) As Double 'Giacenza media
Dim varnum As Variant
Dim strWhere, strSQL As String
Dim db0 As Database
Dim rs As New ADODB.Recordset
Dim Costo_unit_ord As Variant
Dim DatiGen As New ADODB.Recordset
Dim conn As ADODB.Connection
Set db0 = CurrentDb
Set conn = CurrentProject.Connection
'memorizzo il Costo di Acquisto
DatiGen.Open "tblDatiGenerali", conn, adOpenKeyset, adLockOptimistic
    Costo_unit_ord = DatiGen.Fields("Costo_Unit_Ord")
DatiGen.Close

On Error GoTo ErrLine
' **************************************************************************************************
' leggo i Livelli di Servizio
' **************************************************************************************************


' Multiple array
rs.Open "SELECT * FROM [tblCategoriaEventiCvaSimu];", CurrentProject.Connection, _
    adOpenKeyset, adLockOptimistic
  
Do While Not rs.EOF
  For intI = 1 To 8
    For intJ = 1 To 9
'Replace(Me!cboSelection1, ",", ".")
    If IsNull(rs.Fields(intJ + 1)) Then
        LS(intI, intJ) = 0
    Else
        LS(intI, intJ) = Replace(rs.Fields(intJ + 1) * 100, ",", ".") 'Livello servizio da 1 a 10
    End If
    ' Debug.Print intI & intJ & LS(intI, intJ)
    Next intJ
  rs.MoveNext
  Next intI
Loop
rs.Close
Set rs = Nothing
 
' **************************************************************************************************
' *** calcola MATRICE
' **************************************************************************************************
' **************************************************************************************************
' *** calcola riga Qtà No-Picking
' **************************************************************************************************
intI = 1 'riga 1
A = 0
b = 0
c = 0
' calcolo prima ScortaSicurezzaForzata.
'     ***** A1- A4
For intA = 1 To 4
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento Is Null AND AbcConsumoValoreLs = 'A" _
    & intA & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intA) = rs!SSFValo
    Else
        SSF(intI, intA) = 0
    End If
    rs.Close
If LS(intI, intA) > 50 Then
   
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento iS Null AND AbcConsumoValoreLs = 'A" _
    & intA & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intA) = rs!Qta
    Else
        GiacM(intI, intA) = 0
    End If
rs.Close
End If
ctl("txtA" & intA & "Np").Caption = ""
    ctl("txtA" & intA & "Np").Caption = Format(GiacM(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SSF(intI, intA) ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing
'     ***** B1- B3
For intB = 1 To 3
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento IS NULL AND AbcConsumoValoreLs = 'B" _
    & intB & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intB + 4) = rs!SSFValo
    Else
        SSF(intI, intB + 4) = 0
    End If
    rs.Close
If LS(intI, intB + 4) > 50 Then
   
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento IS NULL AND AbcConsumoValoreLs = 'B" _
    & intB & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intB + 4) = rs!Qta
    Else
        GiacM(intI, intB + 4) = 0
    End If
rs.Close
End If
ctl("txtB" & intB & "Np").Caption = ""
ctl("txtB" & intB & "Np").Caption = Format(GiacM(intI, intB + 4) + SS(intI, intB _
    + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga Np B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing

'     ***** C1- C2
For IntC = 1 To 2
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento Is Null AND AbcConsumoValoreLs = 'C" _
    & IntC & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, IntC + 7) = rs!SSFValo
    Else
        SSF(intI, IntC + 7) = 0
    End If
    rs.Close
If LS(intI, IntC + 7) > 50 Then
   
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento iS Null AND AbcConsumoValoreLs = 'C" _
    & IntC & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, IntC + 7) = rs!Qta
    Else
        GiacM(intI, IntC + 7) = 0
    End If
   rs.Close
End If
ctl("txtC" & IntC & "Np").Caption = ""
ctl("txtC" & IntC & "Np").Caption = Format(GiacM(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)  ' Subtotale riga Np dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtNp").Caption = ""
ctl("txtNp").Caption = Format(A + b + c, "#,##0") ' Totale riga Np



' **************************************************************************************************
' *** calcola riga Qtà Very-Slow
' **************************************************************************************************
'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 2
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'A" _
    & intA & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intA) = rs!SSFValo
    Else
        SSF(intI, intA) = 0
    End If
    rs.Close
If LS(intI, intA) > 50 Then
   
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'A" _
    & intA & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intA) = rs!Qta
    Else
        GiacM(intI, intA) = 0
    End If
rs.Close
End If
ctl("txtA" & intA & "Vs").Caption = ""
    ctl("txtA" & intA & "Vs").Caption = Format(GiacM(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SSF(intI, intA) ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'B" _
    & intB & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intB + 4) = rs!SSFValo
    Else
        SSF(intI, intB + 4) = 0
    End If
    rs.Close
If LS(intI, intB + 4) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'B" _
    & intB & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intB + 4) = rs!Qta
    Else
        GiacM(intI, intB + 4) = 0
    End If
rs.Close
End If
ctl("txtB" & intB & "Vs").Caption = ""
ctl("txtB" & intB & "Vs").Caption = Format(GiacM(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga Np B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
End Select
ctl("txtB" & intB & "Vs").Caption = ""
ctl("txtB" & intB & "Vs").Caption = Format(GiacM(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
Next intB
Set rs = Nothing
' ok fatto

'     ***** C1- C2
For IntC = 1 To 2
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, IntC + 7) = rs!SSFValo
    Else
        SSF(intI, IntC + 7) = 0
    End If
    rs.Close
If LS(intI, IntC + 7) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'C" _
    & IntC & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, IntC + 7) = rs!Qta
    Else
        GiacM(intI, IntC + 7) = 0
    End If
rs.Close
End If
ctl("txtC" & IntC & "Vs").Caption = ""
ctl("txtC" & IntC & "Vs").Caption = Format(GiacM(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7) ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtVs").Caption = ""
ctl("txtVs").Caption = Format(A + b + c, "#,##0") ' Totale riga Vs

' **************************************************************************************************
' *** calcola riga Qtà Slow
' **************************************************************************************************
'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 3
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'A" _
    & intA & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intA) = rs!SSFValo
    Else
        SSF(intI, intA) = 0
    End If
    rs.Close
If LS(intI, intA) > 50 Then
   
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'A" _
    & intA & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intA) = rs!Qta
    Else
        GiacM(intI, intA) = 0
    End If
rs.Close
End If
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SSF(intI, intA)
End Select
ctl("txtA" & intA & "S").Caption = ""
    ctl("txtA" & intA & "S").Caption = Format(GiacM(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SSF(intI, intA)  ' Subtotale  riga A
Next intA

Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'B" _
    & intB & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intB + 4) = rs!SSFValo
    Else
        SSF(intI, intB + 4) = 0
    End If
    rs.Close
If LS(intI, intB + 4) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'B" _
    & intB & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intB + 4) = rs!Qta
    Else
        GiacM(intI, intB + 4) = 0
    End If
rs.Close
End If
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
End Select
ctl("txtB" & intB & "S").Caption = ""
ctl("txtB" & intB & "S").Caption = Format(GiacM(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SSF(intI, intB + 4)  ' Subtotale riga B
Next intB

Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, IntC + 7) = rs!SSFValo
    Else
        SSF(intI, IntC + 7) = 0
    End If
    rs.Close
If LS(intI, IntC + 7) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'C" _
    & IntC & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, IntC + 7) = rs!Qta
    Else
        GiacM(intI, IntC + 7) = 0
    End If
  rs.Close
End If
ctl("txtC" & IntC & "S").Caption = ""
ctl("txtC" & IntC & "S").Caption = Format(GiacM(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7) ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtS").Caption = ""
ctl("txtS").Caption = Format(A + b + c, "#,##0") ' Totale riga S
ctl("txtA1").Caption = ""
ctl("txtA1").Caption = ctl("txtA1s").Caption

' **************************************************************************************************
' *** calcola riga Qtà Medium Slow
' **************************************************************************************************
'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 4
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'A" _
    & intA & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intA) = rs!SSFValo
    Else
        SSF(intI, intA) = 0
    End If
    rs.Close
If LS(intI, intA) > 50 Then
   
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'A" _
    & intA & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intA) = rs!Qta
    Else
        GiacM(intI, intA) = 0
    End If
rs.Close
End If
    ctl("txtA" & intA & "Ms").Caption = ""
    ctl("txtA" & intA & "Ms").Caption = Format(GiacM(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SSF(intI, intA) ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'B" _
    & intB & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intB + 4) = rs!SSFValo
    Else
        SSF(intI, intB + 4) = 0
    End If
    rs.Close
If LS(intI, intB + 4) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'B" _
    & intB & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intB + 4) = rs!Qta
    Else
        GiacM(intI, intB + 4) = 0
    End If
rs.Close
End If
ctl("txtB" & intB & "Ms").Caption = ""
ctl("txtB" & intB & "Ms").Caption = Format(GiacM(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, IntC + 7) = rs!SSFValo
    Else
        SSF(intI, IntC + 7) = 0
    End If
    rs.Close
If LS(intI, IntC + 7) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'C" _
    & IntC & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, IntC + 7) = rs!Qta
    Else
        GiacM(intI, IntC + 7) = 0
    End If
  rs.Close
End If
ctl("txtC" & IntC & "Ms").Caption = ""
ctl("txtC" & IntC & "Ms").Caption = Format(GiacM(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)  ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtMs").Caption = ""
ctl("txtMs").Caption = Format(A + b + c, "#,##0") ' Totale riga Ms





' **************************************************************************************************
' *** calcola riga Qtà Medium
' **************************************************************************************************

'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 5
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'A" _
    & intA & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intA) = rs!SSFValo
    Else
        SSF(intI, intA) = 0
    End If
    rs.Close
If LS(intI, intA) > 50 Then
   
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'A" _
    & intA & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intA) = rs!Qta
    Else
        GiacM(intI, intA) = 0
    End If
rs.Close
End If
    ctl("txtA" & intA & "M").Caption = ""
    ctl("txtA" & intA & "M").Caption = Format(GiacM(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SSF(intI, intA)  ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'B" _
    & intB & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intB + 4) = rs!SSFValo
    Else
        SSF(intI, intB + 4) = 0
    End If
    rs.Close
If LS(intI, intB + 4) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'B" _
    & intB & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intB + 4) = rs!Qta
    Else
        GiacM(intI, intB + 4) = 0
    End If
rs.Close
End If
ctl("txtB" & intB & "M").Caption = ""
ctl("txtB" & intB & "M").Caption = Format(GiacM(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, IntC + 7) = rs!SSFValo
    Else
        SSF(intI, IntC + 7) = 0
    End If
    rs.Close
If LS(intI, IntC + 7) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'C" _
    & IntC & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, IntC + 7) = rs!Qta
    Else
        GiacM(intI, IntC + 7) = 0
    End If
   rs.Close
End If
ctl("txtC" & IntC & "M").Caption = ""
ctl("txtC" & IntC & "M").Caption = Format(GiacM(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)  ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtM").Caption = ""
ctl("txtM").Caption = Format(A + b + c, "#,##0") ' Totale riga M



' **************************************************************************************************
' *** calcola riga Qtà Medium Fast
' **************************************************************************************************
'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 6
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'A" _
    & intA & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intA) = rs!SSFValo
    Else
        SSF(intI, intA) = 0
    End If
    rs.Close
If LS(intI, intA) > 50 Then
   
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'A" _
    & intA & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intA) = rs!Qta
    Else
        GiacM(intI, intA) = 0
    End If
rs.Close
End If
    ctl("txtA" & intA & "Mf").Caption = ""
    ctl("txtA" & intA & "Mf").Caption = Format(GiacM(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SSF(intI, intA)  ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Medium-fast' AND AbcConsumoValoreLs = 'B" _
    & intB & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intB + 4) = rs!SSFValo
    Else
        SSF(intI, intB + 4) = 0
    End If
    rs.Close
If LS(intI, intB + 4) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'B" _
    & intB & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intB + 4) = rs!Qta
    Else
        GiacM(intI, intB + 4) = 0
    End If
rs.Close
End If
ctl("txtB" & intB & "Mf").Caption = ""
ctl("txtB" & intB & "Mf").Caption = Format(GiacM(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SSF(intI, intB + 4)  ' Subtotale riga B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, IntC + 7) = rs!SSFValo
    Else
        SSF(intI, IntC + 7) = 0
    End If
    rs.Close
If LS(intI, IntC + 7) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'C" _
    & IntC & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, IntC + 7) = rs!Qta
    Else
        GiacM(intI, IntC + 7) = 0
    End If
  rs.Close
End If
ctl("txtC" & IntC & "Mf").Caption = ""
ctl("txtC" & IntC & "Mf").Caption = Format(GiacM(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)  ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtMF").Caption = ""
ctl("txtMF").Caption = Format(A + b + c, "#,##0") ' Totale riga Mf
' **************************************************************************************************
' *** calcola riga Qtà Fast
' **************************************************************************************************
'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 7
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'A" _
    & intA & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intA) = rs!SSFValo
    Else
        SSF(intI, intA) = 0
    End If
    rs.Close
If LS(intI, intA) > 50 Then
   
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'A" _
    & intA & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intA) = rs!Qta
    Else
        GiacM(intI, intA) = 0
    End If
rs.Close
End If
    ctl("txtA" & intA & "F").Caption = ""
    ctl("txtA" & intA & "F").Caption = Format(GiacM(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SSF(intI, intA)  ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'B" _
    & intB & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intB + 4) = rs!SSFValo
    Else
        SSF(intI, intB + 4) = 0
    End If
    rs.Close
If LS(intI, intB + 4) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'B" _
    & intB & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intB + 4) = rs!Qta
    Else
        GiacM(intI, intB + 4) = 0
    End If
rs.Close
End If
ctl("txtB" & intB & "F").Caption = ""
ctl("txtB" & intB & "F").Caption = Format(GiacM(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SSF(intI, intB + 4)  ' Subtotale riga B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, IntC + 7) = rs!SSFValo
    Else
        SSF(intI, IntC + 7) = 0
    End If
    rs.Close
If LS(intI, IntC + 7) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'C" _
    & IntC & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, IntC + 7) = rs!Qta
    Else
        GiacM(intI, IntC + 7) = 0
    End If
  rs.Close
End If
ctl("txtC" & IntC & "F").Caption = ""
ctl("txtC" & IntC & "F").Caption = Format(GiacM(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)  ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtF").Caption = ""
ctl("txtF").Caption = Format(A + b + c, "#,##0") ' Totale riga F
' **************************************************************************************************
' *** calcola riga Qtà Very Fast
' **************************************************************************************************
'     ***** A1- A4
intI = 8
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'A" _
    & intA & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intA) = rs!SSFValo
    Else
        SSF(intI, intA) = 0
    End If
    rs.Close
If LS(intI, intA) > 50 Then
   
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'A" _
    & intA & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intA) = rs!Qta
    Else
        GiacM(intI, intA) = 0
    End If
rs.Close
End If
ctl("txtA" & intA & "Vf").Caption = ""
    ctl("txtA" & intA & "Vf").Caption = Format(GiacM(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SSF(intI, intA) ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'B" _
    & intB & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, intB + 4) = rs!SSFValo
    Else
        SSF(intI, intB + 4) = 0
    End If
    rs.Close
If LS(intI, intB + 4) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'B" _
    & intB & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, intB + 4) = rs!Qta
    Else
        GiacM(intI, intB + 4) = 0
    End If
rs.Close
End If
ctl("txtB" & intB & "Vf").Caption = ""
ctl("txtB" & intB & "Vf").Caption = Format(GiacM(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
rs.Open _
    "SELECT Count(tblArticoliStato.ScortaSicurezzaForzata) AS SSFValo " _
    & _
    "FROM tblArticoli INNER JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoliStato.ScortaSicurezzaForzata > 0 and tblArticoli.Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!SSFValo Then
        SSF(intI, IntC + 7) = rs!SSFValo
    Else
        SSF(intI, IntC + 7) = 0
    End If
    rs.Close
If LS(intI, IntC + 7) > 50 Then
   rs.Open _
    "SELECT Count(tblArticoli.Cod_art) AS Qta " _
    & _
    "FROM tblArticoli LEFT JOIN tblArticoliStato ON tblArticoli.Cod_art = tblArticoliStato.Cod_Art " _
    & _
    "WHERE tblArticoli.Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'C" _
    & IntC & "' AND ((tblArticoliStato.ScortaSicurezzaForzata) Is Null Or (tblArticoliStato.ScortaSicurezzaForzata)=0) AND Lotto_ec_acq <> 0 ; ", CurrentProject.Connection, adOpenKeyset, adLockOptimistic
    If Not rs!Qta Then
        GiacM(intI, IntC + 7) = rs!Qta
    Else
        GiacM(intI, IntC + 7) = 0
    End If
  rs.Close
End If
ctl("txtC" & IntC & "Vf").Caption = ""
ctl("txtC" & IntC & "Vf").Caption = Format(GiacM(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)  ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtVF").Caption = Format(A + b + c, "#,##0") ' Totale riga Vf
' **************************************************************************************************
' *** calcola totale colonna
' **************************************************************************************************
TotCol = A1 + A2 + A3 + A4 + B1 + B2 + B3 + C1 + C2
ctl("txtTot").Caption = Format(TotCol, "#,##0")
' Me.txtTot.Caption = Format((A1 + A2 + A3 + A4 + B1 + B2 + B3 + C1 + C2), "#,##0")

ctl("txtA1").Caption = Format(A1, "#,##0")
ctl("txtA2").Caption = Format(A2, "#,##0")
ctl("txtA3").Caption = Format(A3, "#,##0")
ctl("txtA4").Caption = Format(A4, "#,##0")
ctl("txtB1").Caption = Format(B1, "#,##0")
ctl("txtB2").Caption = Format(B2, "#,##0")
ctl("txtB3").Caption = Format(B3, "#,##0")
ctl("txtC1").Caption = Format(C1, "#,##0")
ctl("txtC2").Caption = Format(C2, "#,##0")

' Aggiorna tblDashBoard  con numero cod in giacenza
Actual = DLookup("Actual", "tblDashBoard", "Indice = 'Giacenza'")
If Actual > 0 Then
VPcntIndice = Format(TotCol / Actual, "#.#0")
db0.Execute "UPDATE tblDashBoard SET Target = " & TotCol & ", " & _
            "PcntIndice = " & Replace(VPcntIndice, ",", ".") & _
            " Where Indice = 'Giacenza'", dbFailOnError
End If
 LoadDataFrmCategoriaEventiCvaQtaCalcOk = True
 Forms!frmCategoriaEventiCvaMonitor.SetFocus
   
ExitLine:
   Exit Function
ErrLine:
   LoadDataFrmCategoriaEventiCvaQtaCalcOk = False
   Resume ExitLine
End Function

Private Function LoadDataFrmCategoriaEventiCvaVal(frm As Form, ctl As control)
Dim intI As Integer
Dim A1, A2, A3, A4, B1, B2, B3, C1, C2, D As Double
Dim varnum As Variant
Dim strWhere As String
Dim db0 As Database
Dim DatiGen As New ADODB.Recordset
Dim conn As ADODB.Connection
Set db0 = CurrentDb
Set conn = CurrentProject.Connection
Dim SSF(4) As Double
Dim SSFT As Double
Dim SSFTC As Double
Dim rs As New ADODB.Recordset
Dim TotCol As Variant


' **************************************************************************************************
' *** calcola riga Qtà No-Picking
' **************************************************************************************************
'***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "Np").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'A" & intI & _
    "'"), "#,##0")
Next intI

'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "Np").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'B" & intI & _
    "'"), "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "Np").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'C" & intI & _
    "'"), "#,##0")
Next intI
'     ***** D
ctl("txtDNp").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'D'"), "#,##0")

'     ***** Totale
ctl("txtNp").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento IS NULL"), "#,##0")

' **************************************************************************************************
' *** calcola riga Qtà Very-Slow
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "Vs").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'A" & intI _
    & "'"), "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "Vs").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'B" & intI _
    & "'"), "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "Vs").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'C" & intI _
    & "'"), "#,##0")
Next intI
'     ***** D
ctl("txtDVs").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'D'"), "#,##0")

'     ***** Totale
ctl("txtVs").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Very-Slow'"), "#,##0")

' **************************************************************************************************
' *** calcola riga Qtà Slow
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "S").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'A" & intI & _
    "'"), "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "S").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'B" & intI & _
    "'"), "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "S").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'C" & intI & _
    "'"), "#,##0")
Next intI
'     ***** D
ctl("txtDS").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'D'"), "#,##0")

'     ***** Totale
ctl("txtS").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Slow'"), _
    "#,##0")

' **************************************************************************************************
' *** calcola riga Qtà Medium-Slow
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "MS").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'A" & _
    intI & "'"), "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "MS").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'B" & _
    intI & "'"), "#,##0")

Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "MS").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'C" & _
    intI & "'"), "#,##0")

Next intI
'     ***** D
ctl("txtDMs").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'D'"), "#,##0")

'     ***** Totale
ctl("txtMs").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium-Slow'"), "#,##0")
' **************************************************************************************************
' *** calcola riga Qtà Medium
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "M").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'A" & intI & _
    "'"), "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "M").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'B" & intI & _
    "'"), "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "M").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'C" & intI & _
    "'"), "#,##0")
Next intI
'     ***** D
ctl("txtDM").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'D'"), "#,##0")

'     ***** Totale
ctl("txtM").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium'"), "#,##0")
' **************************************************************************************************
' *** calcola riga Qtà Medium Fast
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "MF").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'A" & _
    intI & "'"), "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "MF").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'B" & _
    intI & "'"), "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "MF").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'C" & _
    intI & "'"), "#,##0")
Next intI
'     ***** D
ctl("txtDMf").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'D'"), "#,##0")
'     ***** Totale
ctl("txtMF").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Medium-Fast'"), "#,##0")
' **************************************************************************************************
' *** calcola riga Qtà Fast
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "F").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'A" & intI & _
    "'"), "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "F").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'B" & intI & _
    "'"), "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "F").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'C" & intI & _
    "'"), "#,##0")
Next intI
'     ***** D
ctl("txtDF").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'D'"), "#,##0")
'     ***** Totale
ctl("txtF").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Fast'"), "#,##0")
' **************************************************************************************************
' *** calcola riga Qtà Very Fast
' **************************************************************************************************
'     ***** A1- A4
For intI = 1 To 4
ctl("txtA" & intI & "VF").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'A" & intI _
    & "'"), "#,##0")
Next intI
'     ***** B1- B3
For intI = 1 To 3
ctl("txtB" & intI & "VF").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'B" & intI _
    & "'"), "#,##0")
Next intI
'     ***** C1- C2
For intI = 1 To 2
ctl("txtC" & intI & "VF").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'C" & intI _
    & "'"), "#,##0")
Next intI
'     ***** D
ctl("txtDVf").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'D'"), "#,##0")

'     ***** Totale
ctl("txtVF").Caption = _
    Format(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "Classe_Evento = 'Very-Fast'"), "#,##0")

' **************************************************************************************************
' *** calcola totale colonna
' **************************************************************************************************
' A1

A1 = _
    DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "AbcConsumoValoreLs = 'A1'")
'A2
A2 = _
    DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "AbcConsumoValoreLs = 'A2'")
'A3
A3 = _
    DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "AbcConsumoValoreLs = 'A3'")
'A4
A4 = _
    DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "AbcConsumoValoreLs = 'A4'")
'B1
B1 = _
    DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "AbcConsumoValoreLs = 'B1'")

'B2
B2 = _
    DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "AbcConsumoValoreLs = 'B2'") + SSFTC
'B3
B3 = _
    DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "AbcConsumoValoreLs = 'B3'")
'C1
C1 = _
    DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
    "tblArticoli", "AbcConsumoValoreLs = 'C1'")
'C2
' strWhere = "tblArticoli.Lotto_ec_acq > 0 AND AbcConsumoValoreLs = 'C2'"
' varnum = DMax("tblArticoli.Cod_art", "tblArticoli", strWhere) + SSFTC
'If Not IsNothing(varnum) Then
C2 = _
        DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "AbcConsumoValoreLs = 'C2'")
'D
If IsNull(DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "AbcConsumoValoreLs = 'D'")) Then
        D = 0
Else
D = _
        DSum("(tblArticoli.giac_media)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "AbcConsumoValoreLs = 'D'")
End If
TotCol = A1 + A2 + A3 + A4 + B1 + B2 + B3 + C1 + C2 + D
ctl("txtTot").Caption = Format(TotCol, "#,##0")
ctl("txtA1").Caption = Format(A1, "#,##0")
ctl("txtA2").Caption = Format(A2, "#,##0")
ctl("txtA3").Caption = Format(A3, "#,##0")
ctl("txtA4").Caption = Format(A4, "#,##0")
ctl("txtB1").Caption = Format(B1, "#,##0")
ctl("txtB2").Caption = Format(B2, "#,##0")
ctl("txtB3").Caption = Format(B3, "#,##0")
ctl("txtC1").Caption = Format(C1, "#,##0")
ctl("txtC2").Caption = Format(C2, "#,##0")
ctl("txtD").Caption = Format(D, "#,##0")
' Aggiorna tblDashBoard  con numero cod in giacenza
If TotCol > 0 Then
Set db0 = CurrentDb
    db0.Execute "UPDATE tblDashBoard SET Actual = " & Replace(TotCol, ",", ".") & _
                " Where Indice = 'Giacenza_Valo'", dbFailOnError
End If
 LoadDataFrmCategoriaEventiCvaValOk = True
 Forms!frmCategoriaEventiCvaMonitor.SetFocus
  
ExitLine:
   Exit Function
ErrLine:
   LoadDataFrmCategoriaEventiCvaValOk = False
   Resume ExitLine

End Function

Private Function LoadDataFrmCategoriaEventiCvaValCalc(frm As Form, ctl As control)
Dim intI As Integer
Dim intJ As Integer
Dim intA As Integer
Dim intB As Integer
Dim IntC As Integer
Dim A1, A2, A3, A4, B1, B2, B3, C1, C2 As Double ' Totale Colonne
Dim A, b, c As Double 'Subtotali righe
Dim Np, Vs, s, Ms, M, Mf, f, Vf As Double  'Totale righe
Dim SS1 As Variant
Dim SS(8, 9) As Variant
Dim SSF(8, 9) As Variant
Dim LS(8, 9) As Variant
Dim GiacM(8, 9) As Variant 'Giacenza media
Dim varnum As Variant
Dim strWhere As String
Dim Actual, TotCol, VPcntIndice As Variant
Dim db0 As Database
Dim rs As New ADODB.Recordset
Dim Costo_unit_ord As Variant
Dim DatiGen As New ADODB.Recordset
Dim conn As ADODB.Connection
Dim SSFValo As Variant
Set db0 = CurrentDb
Set conn = CurrentProject.Connection

'memorizzo il Costo di Acquisto
DatiGen.Open "tblDatiGenerali", conn, adOpenKeyset, adLockOptimistic
    Costo_unit_ord = DatiGen.Fields("Costo_Unit_Ord")
DatiGen.Close


' **************************************************************************************************
' leggo i Livelli di Servizio
' **************************************************************************************************


' Multiple array
rs.Open "SELECT * FROM [tblCategoriaEventiCvaSimu];", CurrentProject.Connection, _
    adOpenKeyset, adLockOptimistic
  
Do While Not rs.EOF
  For intI = 1 To 8
    For intJ = 1 To 9
'Replace(Me!cboSelection1, ",", ".")
    If IsNull(rs.Fields(intJ + 1)) Then
        LS(intI, intJ) = 0
    Else
        LS(intI, intJ) = Replace(rs.Fields(intJ + 1) * 100, ",", ".") 'Livello servizio da 1 a 10
    End If
    ' Debug.Print intI & intJ & LS(intI, intJ)
    Next intJ
  rs.MoveNext
  Next intI
Loop
rs.Close
Set rs = Nothing

' **************************************************************************************************
' *** calcola MATRICE
' **************************************************************************************************
' **************************************************************************************************
' *** calcola riga Qtà No-Picking
' **************************************************************************************************
intI = 1 'riga 1
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4

strWhere = "Classe_Evento = ' ' AND AbcConsumoValoreLs = 'A" _
    & intA & "'"


SSFValo = DLookup("SSFValo", "qrySSFValo", strWhere)
If IsNull(SSFValo) Then
    SSF(intI, intA) = 0
Else
SSF(intI, intA) = SSFValo
End If

If LS(intI, intA) <= 50 Then
    SS(intI, intA) = 0
    GiacM(intI, intA) = 0
Else
        SS(intI, intA) = DSum("ScortaSicurezza(" & LS(intI, intA) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'A" & intA & "'")
        If IsNull(SS(intI, intA)) Then SS(intI, intA) = 0
        
        GiacM(intI, intA) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'A" & intA _
        & "'")
        If IsNull(GiacM(intI, intA)) Then GiacM(intI, intA) = 0
End If
ctl("txtA" & intA & "Np").Caption = ""
ctl("txtA" & intA & "Np").Caption = _
    Format(GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA) ' Subtotale  riga Np per A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
End Select
Next intA


'     ***** B1- B3
For intB = 1 To 3

SSF(intI, intB + 4) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento Is Null AND AbcConsumoValoreLs = 'B" _
    & intB & "'")
If IsNull(SSF(intI, intB + 4)) Then SSF(intI, intB + 4) = 0


If LS(intI, intB + 4) <= 50 Then
    SS(intI, intB + 4) = 0
    GiacM(intI, intB + 4) = 0
Else
        SS(intI, intB + 4) = DSum("ScortaSicurezza(" & LS(intI, intB + 4) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'B" & intB & "'")
        If IsNull(SS(intI, intB + 4)) Then SS(intI, intB + 4) = 0
        
        GiacM(intI, intB + 4) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'B" & intB _
        & "'")
        If IsNull(GiacM(intI, intB + 4)) Then GiacM(intI, intB + 4) = 0
End If
ctl("txtB" & intB & "Np").Caption = ""
ctl("txtB" & intB & "Np").Caption = _
    Format(GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga Np B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing
'     ***** C1- C2
For IntC = 1 To 2

SSF(intI, IntC + 7) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento Is Null AND AbcConsumoValoreLs = 'C" _
    & IntC & "'")
If IsNull(SSF(intI, IntC + 7)) Then SSF(intI, IntC + 7) = 0

    
If LS(intI, IntC + 7) <= 50 Then
    SS(intI, IntC + 7) = 0
    GiacM(intI, IntC + 7) = 0
Else
        SS(intI, IntC + 7) = DSum("ScortaSicurezza(" & LS(intI, IntC + 7) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'C" & IntC & "'")
        If IsNull(SS(intI, IntC + 7)) Then SS(intI, IntC + 7) = 0
    
        GiacM(intI, IntC + 7) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento IS NULL AND AbcConsumoValoreLs = 'C" & IntC _
        & "'")
        If IsNull(GiacM(intI, IntC + 7)) Then GiacM(intI, IntC + 7) = 0
End If
ctl("txtC" & IntC & "Np").Caption = ""
ctl("txtC" & IntC & "Np").Caption = _
    Format(GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7) ' Subtotale riga Np dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtNp").Caption = ""
ctl("txtNp").Caption = Format(A + b + c, "#,##0") ' Totale riga Np



' **************************************************************************************************
' *** calcola riga Qtà Very-Slow
' **************************************************************************************************
'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 2
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
SSF(intI, intA) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'A" _
    & intA & "'")
If IsNull(SSF(intI, intA)) Then SSF(intI, intA) = 0

    
If LS(intI, intA) <= 50 Then
    SS(intI, intA) = 0
    GiacM(intI, intA) = 0
Else
        SS(intI, intA) = DSum("ScortaSicurezza(" & LS(intI, intA) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'A" & intA & "'")
        If IsNull(SS(intI, intA)) Then SS(intI, intA) = 0
    
        GiacM(intI, intA) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
         "tblArticoli", "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'A" & intA _
        & "'")
        If IsNull(GiacM(intI, intA)) Then GiacM(intI, intA) = 0
End If
ctl("txtA" & intA & "Vs").Caption = ""
    ctl("txtA" & intA & "Vs").Caption = _
    Format(GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA) ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
SSF(intI, intB + 4) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'B" _
    & intB & "'")
If IsNull(SSF(intI, intB + 4)) Then SSF(intI, intB + 4) = 0
  
If LS(intI, intB + 4) <= 50 Then
    SS(intI, intB + 4) = 0
    GiacM(intI, intB + 4) = 0
Else
        SS(intI, intB + 4) = DSum("ScortaSicurezza(" & LS(intI, intB + 4) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'B" & intB & "'")
        If IsNull(SS(intI, intB + 4)) Then SS(intI, intB + 4) = 0
    
        GiacM(intI, intB + 4) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'B" & intB _
        & "'")
        If IsNull(GiacM(intI, intA)) Then GiacM(intI, intA) = 0
End If
ctl("txtB" & intB & "Vs").Caption = ""
ctl("txtB" & intB & "Vs").Caption = _
    Format(GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2

SSF(intI, IntC + 7) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'")
If IsNull(SSF(intI, IntC + 7)) Then SSF(intI, IntC + 7) = 0

If LS(intI, IntC + 7) <= 50 Then
    SS(intI, IntC + 7) = 0
     GiacM(intI, IntC + 7) = 0
Else
        SS(intI, IntC + 7) = DSum("ScortaSicurezza(" & LS(intI, IntC + 7) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'C" & IntC & "'")
        If IsNull(SS(intI, IntC + 7)) Then SS(intI, IntC + 7) = 0
            
        GiacM(intI, IntC + 7) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
            "tblArticoli", "Classe_Evento = 'Very-Slow' AND AbcConsumoValoreLs = 'C" & IntC _
            & "'")
        If IsNull(GiacM(intI, IntC + 7)) Then GiacM(intI, IntC + 7) = 0
End If
ctl("txtC" & IntC & "Vs").Caption = ""
ctl("txtC" & IntC & "Vs").Caption = _
    Format(GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7) ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtVs").Caption = ""
ctl("txtVs").Caption = Format(A + b + c, "#,##0") ' Totale riga Vs

' **************************************************************************************************
' *** calcola riga Qtà Slow
' **************************************************************************************************
'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 3
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
SSF(intI, intA) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'A" _
    & intA & "'")
If IsNull(SSF(intI, intA)) Then SSF(intI, intA) = 0
If LS(intI, intA) <= 50 Then
    SS(intI, intA) = 0
    GiacM(intI, intA) = 0
Else
        SS(intI, intA) = DSum("ScortaSicurezza(" & LS(intI, intA) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'A" & intA & "'")
        If IsNull(SS(intI, intA)) Then SS(intI, intA) = 0
    
    
        GiacM(intI, intA) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
         "tblArticoli", "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'A" & intA _
        & "'")
        If IsNull(GiacM(intI, intA)) Then GiacM(intI, intA) = 0
End If
ctl("txtA" & intA & "S").Caption = ""
    ctl("txtA" & intA & "S").Caption = _
    Format(GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA) ' Subtotale  riga A
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
SSF(intI, intB + 4) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'B" _
    & intB & "'")
If IsNull(SSF(intI, intB + 4)) Then SSF(intI, intB + 4) = 0

If LS(intI, intB + 4) <= 50 Then
    SS(intI, intB + 4) = 0
    GiacM(intI, intB + 4) = 0
Else
        SS(intI, intB + 4) = DSum("ScortaSicurezza(" & LS(intI, intB + 4) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'B" & intB & "'")
        If IsNull(SS(intI, intB + 4)) Then SS(intI, intB + 4) = 0
        
        GiacM(intI, intB + 4) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'B" & intB _
        & "'")
        If IsNull(GiacM(intI, intB + 4)) Then GiacM(intI, intB + 4) = 0
End If
ctl("txtB" & intB & "S").Caption = ""
ctl("txtB" & intB & "S").Caption = _
    Format(GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga B
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
SSF(intI, IntC + 7) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'")
If IsNull(SSF(intI, IntC + 7)) Then SSF(intI, IntC + 7) = 0

If LS(intI, IntC + 7) <= 50 Then
    SS(intI, IntC + 7) = 0
    GiacM(intI, IntC + 7) = 0
Else
        SS(intI, IntC + 7) = DSum("ScortaSicurezza(" & LS(intI, IntC + 7) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'C" & IntC & "'")
        If IsNull(SS(intI, IntC + 7)) Then SS(intI, IntC + 7) = 0
        
        GiacM(intI, IntC + 7) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Slow' AND AbcConsumoValoreLs = 'C" & IntC _
        & "'")
        If IsNull(GiacM(intI, IntC + 7)) Then GiacM(intI, IntC + 7) = 0
End If
ctl("txtC" & IntC & "S").Caption = ""
ctl("txtC" & IntC & "S").Caption = _
    Format(GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7) ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtS").Caption = ""
ctl("txtS").Caption = Format(A + b + c, "#,##0") ' Totale riga S
ctl("txtA1").Caption = ""
ctl("txtA1").Caption = ctl("txtA1s").Caption

' **************************************************************************************************
' *** calcola riga Qtà Medium Slow
' **************************************************************************************************
'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 4
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
SSF(intI, intA) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'A" _
    & intA & "'")
If IsNull(SSF(intI, intA)) Then SSF(intI, intA) = 0
If LS(intI, intA) <= 50 Then
    SS(intI, intA) = 0
    GiacM(intI, intA) = 0
Else
        SS(intI, intA) = DSum("ScortaSicurezza(" & LS(intI, intA) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'A" & intA & "'")
        If IsNull(SS(intI, intA)) Then SS(intI, intA) = 0
    
        GiacM(intI, intA) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
         "tblArticoli", "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'A" & intA _
        & "'")
        If IsNull(GiacM(intI, intA)) Then GiacM(intI, intA) = 0
End If
    ctl("txtA" & intA & "Ms").Caption = ""
    ctl("txtA" & intA & "Ms").Caption = _
    Format(GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA) ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
SSF(intI, intB + 4) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'B" _
    & intB & "'")
If IsNull(SSF(intI, intB + 4)) Then SSF(intI, intB + 4) = 0

If LS(intI, intB + 4) <= 50 Then
    SS(intI, intB + 4) = 0
    GiacM(intI, intB + 4) = 0
Else
        SS(intI, intB + 4) = DSum("ScortaSicurezza(" & LS(intI, intB + 4) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'B" & intB & "'")
        If IsNull(SS(intI, intB + 4)) Then SS(intI, intB + 4) = 0
        
        GiacM(intI, intB + 4) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'B" & intB _
        & "'")
        If IsNull(GiacM(intI, intB + 4)) Then GiacM(intI, intB + 4) = 0
End If
ctl("txtB" & intB & "Ms").Caption = ""
ctl("txtB" & intB & "Ms").Caption = _
    Format(GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
SSF(intI, IntC + 7) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'")
If IsNull(SSF(intI, IntC + 7)) Then SSF(intI, IntC + 7) = 0

If LS(intI, IntC + 7) <= 50 Then
    SS(intI, IntC + 7) = 0
     GiacM(intI, IntC + 7) = 0
Else
        SS(intI, IntC + 7) = DSum("ScortaSicurezza(" & LS(intI, IntC + 7) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'C" & IntC & "'")
        If IsNull(SS(intI, IntC + 7)) Then SS(intI, IntC + 7) = 0
    
        GiacM(intI, IntC + 7) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Medium-Slow' AND AbcConsumoValoreLs = 'C" & IntC _
        & "'")
        If IsNull(GiacM(intI, IntC + 7)) Then GiacM(intI, IntC + 7) = 0
End If
ctl("txtC" & IntC & "Ms").Caption = ""
ctl("txtC" & IntC & "Ms").Caption = _
    Format(GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7) ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtMs").Caption = ""
ctl("txtMs").Caption = Format(A + b + c, "#,##0") ' Totale riga Ms





' **************************************************************************************************
' *** calcola riga Qtà Medium
' **************************************************************************************************

'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 5
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
SSF(intI, intA) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'A" _
    & intA & "'")
If IsNull(SSF(intI, intA)) Then SSF(intI, intA) = 0
If LS(intI, intA) <= 50 Then
    SS(intI, intA) = 0
    GiacM(intI, intA) = 0
Else
        SS(intI, intA) = DSum("ScortaSicurezza(" & LS(intI, intA) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'A" & intA & "'")
        If IsNull(SS(intI, intA)) Then SS(intI, intA) = 0
        
        GiacM(intI, intA) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
         "tblArticoli", "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'A" & intA _
        & "'")
        If IsNull(GiacM(intI, intA)) Then GiacM(intI, intA) = 0
End If
    ctl("txtA" & intA & "M").Caption = ""
    ctl("txtA" & intA & "M").Caption = _
    Format(GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA) ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
SSF(intI, intB + 4) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'B" _
    & intB & "'")
If IsNull(SSF(intI, intB + 4)) Then SSF(intI, intB + 4) = 0

If LS(intI, intB + 4) <= 50 Then
    SS(intI, intB + 4) = 0
    GiacM(intI, intB + 4) = 0
Else
        SS(intI, intB + 4) = DSum("ScortaSicurezza(" & LS(intI, intB + 4) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'B" & intB & "'")
        If IsNull(SS(intI, intB + 4)) Then SS(intI, intB + 4) = 0
    
        GiacM(intI, intB + 4) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'B" & intB _
        & "'")
        If IsNull(GiacM(intI, intB + 4)) Then GiacM(intI, intB + 4) = 0
End If
ctl("txtB" & intB & "M").Caption = ""
ctl("txtB" & intB & "M").Caption = _
    Format(GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
SSF(intI, IntC + 7) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'")
If IsNull(SSF(intI, IntC + 7)) Then SSF(intI, IntC + 7) = 0

If LS(intI, IntC + 7) <= 50 Then
    SS(intI, IntC + 7) = 0
     GiacM(intI, IntC + 7) = 0
Else
        SS(intI, IntC + 7) = DSum("ScortaSicurezza(" & LS(intI, IntC + 7) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'C" & IntC & "'")
        If IsNull(SS(intI, IntC + 7)) Then SS(intI, IntC + 7) = 0
    
        GiacM(intI, IntC + 7) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Medium' AND AbcConsumoValoreLs = 'C" & IntC _
        & "'")
        If IsNull(GiacM(intI, IntC + 7)) Then GiacM(intI, IntC + 7) = 0
End If
ctl("txtC" & IntC & "M").Caption = ""
ctl("txtC" & IntC & "M").Caption = _
    Format(GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7) ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtM").Caption = ""
ctl("txtM").Caption = Format(A + b + c, "#,##0") ' Totale riga M



' **************************************************************************************************
' *** calcola riga Qtà Medium Fast
' **************************************************************************************************
'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 6
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
SSF(intI, intA) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'A" _
    & intA & "'")
If IsNull(SSF(intI, intA)) Then SSF(intI, intA) = 0
If LS(intI, intA) <= 50 Then
    SS(intI, intA) = 0
    GiacM(intI, intA) = 0
Else
        SS(intI, intA) = DSum("ScortaSicurezza(" & LS(intI, intA) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'A" & intA & "'")
        If IsNull(SS(intI, intA)) Then SS(intI, intA) = 0
        
        GiacM(intI, intA) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
         "tblArticoli", "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'A" & intA _
        & "'")
        If IsNull(GiacM(intI, intA)) Then GiacM(intI, intA) = 0
End If
    ctl("txtA" & intA & "Mf").Caption = ""
    ctl("txtA" & intA & "Mf").Caption = _
    Format(GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA) ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
SSF(intI, intB + 4) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'B" _
    & intB & "'")
If IsNull(SSF(intI, intB + 4)) Then SSF(intI, intB + 4) = 0

If LS(intI, intB + 4) <= 50 Then
    SS(intI, intB + 4) = 0
    GiacM(intI, intB + 4) = 0
Else
        SS(intI, intB + 4) = DSum("ScortaSicurezza(" & LS(intI, intB + 4) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'B" & intB & "'")
        If IsNull(SS(intI, intB + 4)) Then SS(intI, intB + 4) = 0
        
        GiacM(intI, intB + 4) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'B" & intB _
        & "'")
        If IsNull(GiacM(intI, intB + 4)) Then GiacM(intI, intB + 4) = 0
End If
ctl("txtB" & intB & "Mf").Caption = ""
ctl("txtB" & intB & "Mf").Caption = _
    Format(GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
SSF(intI, IntC + 7) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'")
If IsNull(SSF(intI, IntC + 7)) Then SSF(intI, IntC + 7) = 0

If LS(intI, IntC + 7) <= 50 Then
    SS(intI, IntC + 7) = 0
     GiacM(intI, IntC + 7) = 0
Else
        SS(intI, IntC + 7) = DSum("ScortaSicurezza(" & LS(intI, IntC + 7) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'C" & IntC & "'")
        If IsNull(SS(intI, IntC + 7)) Then SS(intI, IntC + 7) = 0
        
        GiacM(intI, IntC + 7) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Medium-Fast' AND AbcConsumoValoreLs = 'C" & IntC _
        & "'")
        If IsNull(GiacM(intI, IntC + 7)) Then GiacM(intI, IntC + 7) = 0
End If
ctl("txtC" & IntC & "Mf").Caption = ""
ctl("txtC" & IntC & "Mf").Caption = _
    Format(GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7) ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtMF").Caption = ""
ctl("txtMF").Caption = Format(A + b + c, "#,##0") ' Totale riga Mf
' **************************************************************************************************
' *** calcola riga Qtà Fast
' **************************************************************************************************
'     ***** A1- A4

intI = 7
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
SSF(intI, intA) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'A" _
    & intA & "'")
If IsNull(SSF(intI, intA)) Then SSF(intI, intA) = 0
If LS(intI, intA) <= 50 Then
    SS(intI, intA) = 0
    GiacM(intI, intA) = 0
Else
        SS(intI, intA) = DSum("ScortaSicurezza(" & LS(intI, intA) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'A" & intA & "'")
        If IsNull(SS(intI, intA)) Then SS(intI, intA) = 0
    
        GiacM(intI, intA) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
         "tblArticoli", "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'A" & intA _
        & "'")
        If IsNull(GiacM(intI, intA)) Then GiacM(intI, intA) = 0
End If
    ctl("txtA" & intA & "F").Caption = ""
    ctl("txtA" & intA & "F").Caption = _
    Format(GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA) ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
SSF(intI, intB + 4) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'B" _
    & intB & "'")
If IsNull(SSF(intI, intB + 4)) Then SSF(intI, intB + 4) = 0

If LS(intI, intB + 4) <= 50 Then
    SS(intI, intB + 4) = 0
    GiacM(intI, intB + 4) = 0
Else
        SS(intI, intB + 4) = DSum("ScortaSicurezza(" & LS(intI, intB + 4) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'B" & intB & "'")
        If IsNull(SS(intI, intB + 4)) Then SS(intI, intB + 4) = 0
    
        GiacM(intI, intB + 4) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'B" & intB _
        & "'")
        If IsNull(GiacM(intI, intB + 4)) Then GiacM(intI, intB + 4) = 0
End If
ctl("txtB" & intB & "F").Caption = ""
ctl("txtB" & intB & "F").Caption = _
    Format(GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
SSF(intI, IntC + 7) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'")
If IsNull(SSF(intI, IntC + 7)) Then SSF(intI, IntC + 7) = 0

If LS(intI, IntC + 7) <= 50 Then
    SS(intI, IntC + 7) = 0
     GiacM(intI, IntC + 7) = 0
Else
        SS(intI, IntC + 7) = DSum("ScortaSicurezza(" & LS(intI, IntC + 7) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'C" & IntC & "'")
        If IsNull(SS(intI, IntC + 7)) Then SS(intI, IntC + 7) = 0
        
        GiacM(intI, IntC + 7) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Fast' AND AbcConsumoValoreLs = 'C" & IntC _
        & "'")
        If IsNull(GiacM(intI, IntC + 7)) Then GiacM(intI, IntC + 7) = 0
End If
ctl("txtC" & IntC & "F").Caption = ""
ctl("txtC" & IntC & "F").Caption = _
    Format(GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7) ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtF").Caption = ""
ctl("txtF").Caption = Format(A + b + c, "#,##0") ' Totale riga F
' **************************************************************************************************
' *** calcola riga Qtà Very Fast
' **************************************************************************************************
'     ***** A1- A4
' *** calcola riga Qtà No-Picking
intI = 8
A = 0
b = 0
c = 0
'     ***** A1- A4
For intA = 1 To 4
SSF(intI, intA) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'A" _
    & intA & "'")
If IsNull(SSF(intI, intA)) Then SSF(intI, intA) = 0
If LS(intI, intA) <= 50 Then
    SS(intI, intA) = 0
    GiacM(intI, intA) = 0
Else
        SS(intI, intA) = DSum("ScortaSicurezza(" & LS(intI, intA) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'A" & intA & "'")
        If IsNull(SS(intI, intA)) Then SS(intI, intA) = 0
    
        GiacM(intI, intA) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
         "tblArticoli", "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'A" & intA _
        & "'")
        If IsNull(GiacM(intI, intA)) Then GiacM(intI, intA) = 0
End If
    ctl("txtA" & intA & "Vf").Caption = ""
    ctl("txtA" & intA & "Vf").Caption = _
    Format(GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA), "#,##0")
A = A + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA) ' Subtotale  riga A
' calcola colonne
Select Case intA
Case Is = 1
    A1 = A1 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 2
    A2 = A2 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 3
    A3 = A3 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
Case Is = 4
    A4 = A4 + GiacM(intI, intA) + SS(intI, intA) + SSF(intI, intA)
End Select
Next intA
Set rs = Nothing

'     ***** B1- B3
For intB = 1 To 3
SSF(intI, intB + 4) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'B" _
    & intB & "'")
If IsNull(SSF(intI, intB + 4)) Then SSF(intI, intB + 4) = 0

If LS(intI, intB + 4) <= 50 Then
    SS(intI, intB + 4) = 0
    GiacM(intI, intB + 4) = 0
Else
        SS(intI, intB + 4) = DSum("ScortaSicurezza(" & LS(intI, intB + 4) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'B" & intB & "'")
        If IsNull(SS(intI, intB + 4)) Then SS(intI, intB + 4) = 0

        GiacM(intI, intB + 4) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'B" & intB _
        & "'")
        If IsNull(GiacM(intI, intB + 4)) Then GiacM(intI, intB + 4) = 0
End If
ctl("txtB" & intB & "Vf").Caption = ""
ctl("txtB" & intB & "Vf").Caption = _
    Format(GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4), "#,##0")
b = b + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4) ' Subtotale riga B
' calcola colonna B
Select Case intB
Case Is = 1
    B1 = B1 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 2
    B2 = B2 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
Case Is = 3
    B3 = B3 + GiacM(intI, intB + 4) + SS(intI, intB + 4) + SSF(intI, intB + 4)
End Select
Next intB
Set rs = Nothing


'     ***** C1- C2
For IntC = 1 To 2
SSF(intI, IntC + 7) = DLookup("SSFValo", "qrySSFValo", "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'C" _
    & IntC & "'")
If IsNull(SSF(intI, IntC + 7)) Then SSF(intI, IntC + 7) = 0

If LS(intI, IntC + 7) <= 50 Then
    SS(intI, IntC + 7) = 0
     GiacM(intI, IntC + 7) = 0
Else
        SS(intI, IntC + 7) = DSum("ScortaSicurezza(" & LS(intI, IntC + 7) & _
        ", tblArticoli.Lead_time, tblArticoli.AvgConsumoMese, " & _
        "tblArticoli.devStdConsumoMese)*(tblArticoli.Cs_Csc)", "tblArticoli", _
        "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'C" & IntC & "'")
        If IsNull(SS(intI, IntC + 7)) Then SS(intI, IntC + 7) = 0

        GiacM(intI, IntC + 7) = DSum("(tblArticoli.Lotto_ec_acq/2)*(tblArticoli.Cs_Csc)", _
        "tblArticoli", "Classe_Evento = 'Very-Fast' AND AbcConsumoValoreLs = 'C" & IntC _
        & "'")
        If IsNull(GiacM(intI, IntC + 7)) Then GiacM(intI, IntC + 7) = 0
End If
ctl("txtC" & IntC & "Vf").Caption = ""
ctl("txtC" & IntC & "Vf").Caption = _
    Format(GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7), "#,##0")
c = c + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7) ' Subtotale riga dei C
' calcola colonne
Select Case IntC
Case Is = 1
    C1 = C1 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
Case Is = 2
    C2 = C2 + GiacM(intI, IntC + 7) + SS(intI, IntC + 7) + SSF(intI, IntC + 7)
End Select
Next IntC
Set rs = Nothing
ctl("txtVF").Caption = Format(A + b + c, "#,##0") ' Totale riga Vf
' **************************************************************************************************
' *** calcola totale colonna
' **************************************************************************************************
TotCol = A1 + A2 + A3 + A4 + B1 + B2 + B3 + C1 + C2
ctl("txtTot").Caption = Format((TotCol), "#,##0")
ctl("txtA1").Caption = Format(A1, "#,##0")
ctl("txtA2").Caption = Format(A2, "#,##0")
ctl("txtA3").Caption = Format(A3, "#,##0")
ctl("txtA4").Caption = Format(A4, "#,##0")
ctl("txtB1").Caption = Format(B1, "#,##0")
ctl("txtB2").Caption = Format(B2, "#,##0")
ctl("txtB3").Caption = Format(B3, "#,##0")
ctl("txtC1").Caption = Format(C1, "#,##0")
ctl("txtC2").Caption = Format(C2, "#,##0")
' Aggiorna tblDashBoard  con numero cod in giacenza
Actual = DLookup("Actual", "tblDashBoard", "Indice = 'Giacenza_Valo'")
If Actual > 0 Then
VPcntIndice = Format(TotCol / Actual, "#.#0")
db0.Execute "UPDATE tblDashBoard SET Target = " & Replace(TotCol, ",", ".") & ", " & _
            "PcntIndice = " & Replace(VPcntIndice, ",", ".") & _
            " Where Indice = 'Giacenza_Valo'", dbFailOnError
End If
    LoadDataFrmCategoriaEventiCvaValCalcOk = True
    Forms!frmCategoriaEventiCvaMonitor.SetFocus

ExitLine:
   Exit Function
ErrLine:
   LoadDataFrmCategoriaEventiCvaValCalcOk = False
   Resume ExitLine

End Function
Private Sub CmdPrint_Click()
MsgBox "Se non salvato, salva i VECCHI VALORI ", vbInformation, gstrAppTitle
If vbYes = MsgBox("Vuoi esportare i dati ? ", vbQuestion + vbYesNo + _
    vbDefaultButton2, gstrAppTitle) Then

    Dim q As Boolean
    Dim Varwhere As Variant
    q = False
    If vbYes = MsgBox("Vuoi esportare tutti gli articoli (Se no tutti diversi da VERY-SLOW e no MOVI) ?", vbQuestion + vbYesNo + _
        vbDefaultButton2, gstrAppTitle) Then
        Varwhere = Null
    Else
        Varwhere = "tblArticoli.Classe_Evento not in ('Very-Slow', '');"
    End If
    Call GenerateCsvRopRoq(Varwhere, q)
Else
Exit Sub
End If
End Sub
Private Sub cmdSave_Click()
'**************************************************
' Copia la Tabella Simu nella tabella Master
'**************************************************
If vbYes = MsgBox("Vuoi salvare le modifiche fatti ai LIVELLI DI SERVIZIO? ", vbQuestion + vbYesNo + _
    vbDefaultButton2, gstrAppTitle) Then
    DoCmd.SetWarnings False
    DoCmd.RunSQL "DELETE * from tblCategoriaEventiCva"
    CurrentProject.Connection.Execute "INSERT INTO tblCategoriaEventiCva SELECT * FROM tblCategoriaEventiCvaSimu"
    'DoCmd.CopyObject , "tblCategoriaEventiCvaSimu", acTable, "tblCategoriaEventiCva"
    DoCmd.SetWarnings True
Else
    Exit Sub
End If
If vbYes = MsgBox("Vuoi aggiornare i Rop e Roq nell'anagrafica articoli? ", vbQuestion + vbYesNo + _
    vbDefaultButton2, gstrAppTitle) Then

'************************************
' Aggiorna Rop e Roq
'************************************

SetRopRoq   'Richiama la Sub

End If

If vbYes = MsgBox("Vuoi creare il file excel con i Rop e Roq? NB. Se non salvato vecchi valori ", vbQuestion + vbYesNo + _
    vbDefaultButton2, gstrAppTitle) Then

'************************************
' Crea file txt
'************************************
'/// Inizia a creare File Csv

Dim q As Boolean
q = False
Call GenerateCsvRopRoq(Varwhere, q)
End If
End Sub


Private Sub cmdCalcola_Click()
  ' Visualizza puntatore mouse a clessidra
    Screen.MousePointer = 11
    ' Forms![frmCategoriaEventiCvaMonitor]![frmCategoriaEventiCvaValCalc].Form.SetLs
    ' Forms![frmCategoriaEventiCvaMonitor]![frmCategoriaEventiCvaQtaCalc].Form.SetLsQta
    Call LoadDataFrmCategoriaEventiCvaQtaCalc(Me, frmCategoriaEventiCvaQtaCalc)
    Call LoadDataFrmCategoriaEventiCvaValCalc(Me, frmCategoriaEventiCvaValCalc)
    ' Visualizza puntatore mouse std
Screen.MousePointer = 1
   ' Forms![frmCategoriaEventiCvaMonitor]![frmCategoriaEventiCvaValCalc].Form.Requery
End Sub
Private Sub cmdClose_Click()
   ' DoCmd.Restore
    DoCmd.Close acForm, Me.name
End Sub
